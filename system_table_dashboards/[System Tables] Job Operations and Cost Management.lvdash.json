{
  "datasets": [
    {
      "name": "bb7e5c78",
      "displayName": "wow_growth",
      "query": "with jobs_usage_with_list_cost as (\n  SELECT\n    t1.*,\n    t1.usage_quantity * list_prices.pricing.default as list_cost\n  FROM\n    system.billing.usage t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n),\nweekly_jobs_list_cost as (\n  select\n    date_sub(\n      to_date(usage_start_time),\n      dayofweek(to_date(usage_start_time))\n    ) as week_start,\n    SUM(list_cost) as list_cost,\n    COUNT(distinct to_date(usage_start_time)) as days\n  from\n    jobs_usage_with_list_cost t1\n  group by\n    all\n  having\n    days = 7\n  order by\n    1 asc,\n    2 asc\n),\nlist_cost_growth as (\n  select\n    week_start,\n    list_cost,\n    100 * (\n      list_cost - lag(list_cost, 1) over (\n        order by\n          week_start\n      )\n    ) / lag(list_cost, 1) over (\n      order by\n        week_start\n    ) as weekly_growth\n  from\n    weekly_jobs_list_cost\n  order by\n    week_start asc\n)\nselect\n  week_start,\n  weekly_growth,\n  avg(weekly_growth) over (\n    order by\n      week_start ROWS BETWEEN 12 preceding\n      AND CURRENT ROW\n  ) as 3_months_growth_moving_avg,\n  list_cost\nfrom\n  list_cost_growth;"
    },
    {
      "name": "07398605",
      "displayName": "job_run_cost",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_org_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name\n  FROM\n    system.billing.usage t1\n    LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n)\nSELECT\n  t1.*\nexcept(team_name),\n  t2.workspace_name,\n  t1.usage_metadata.job_id as job_id,\n  coalesce(t3.name, t1.usage_metadata.job_id) as job_name,\n  ifnull(\n    {catalog}.{schema}.job_type_from_sku(t1.sku_name),\n    'UNKNOWN'\n  ) as job_type_from_sku,\n  ifnull(t1.team_name, 'unknown') as team_name,\n  t1.usage_metadata.job_run_id as run_id,\n  t1.identity_metadata.run_as as run_as,\n  t1.usage_quantity * list_prices.pricing.default AS list_cost\nFROM\n  billing_w_org_team t1\n  INNER JOIN system.billing.list_prices list_prices ON t1.cloud = list_prices.cloud\n  AND t1.sku_name = list_prices.sku_name\n  AND t1.usage_start_time >= list_prices.price_start_time\n  AND (\n    t1.usage_end_time <= list_prices.price_end_time\n    or list_prices.price_end_time is NULL\n  )\n  LEFT JOIN {catalog}.{schema}.workspace_reference t2 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t3 ON t1.workspace_id = t3.workspace_id\n  AND t1.usage_metadata.job_id = t3.job_id\nWHERE\n  t1.billing_origin_product = 'JOBS'\n  AND t1.usage_metadata.job_id IS NOT NULL\n  AND t1.usage_metadata.job_run_id IS NOT NULL;"
    },
    {
      "name": "0655a5b3",
      "displayName": "30_60_days_spend",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_org_team as (\n  SELECT\n    t1.*,\n    t1.usage_metadata.job_id as job_id,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name\n  FROM\n    system.billing.usage t1\n    LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n),\njobs_usage_with_list_cost as (\n  SELECT\n    t1.*,\n    t1.usage_quantity * list_prices.pricing.default as list_cost\n  FROM\n    billing_w_org_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n)\nSELECT\n  t1.*,\n  t3.workspace_name,\n  coalesce(t4.name, t1.job_id) as job_name,\n  try_divide(\n    (last30DaySpend - last30to60DaySpend),\n    last30to60DaySpend\n  ) * 100 AS Last30DayGrowth\nFROM\n  (\n    SELECT\n      SUM(list_cost) AS spend,\n      workspace_id,\n      job_id,\n      sku_name,\n      ifnull(\n        {catalog}.{schema}.job_type_from_sku(sku_name),\n        'UNKNOWN'\n      ) as job_type_from_sku,\n      ifnull(team_name, 'unknown') as team_name,\n      SUM(\n        CASE\n          WHEN usage_end_time BETWEEN date_add(current_date(), -30)\n          AND (current_date() - 1) THEN list_cost\n          ELSE 0\n        END\n      ) AS Last30DaySpend,\n      SUM(\n        CASE\n          WHEN usage_end_time BETWEEN date_add(current_date(), -60)\n          AND date_add(current_date(), -31) THEN list_cost\n          ELSE 0\n        END\n      ) AS Last30to60DaySpend\n    FROM\n      jobs_usage_with_list_cost\n    GROUP BY\n      ALL\n  ) t1\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t4 USING (workspace_id, job_id);"
    },
    {
      "name": "11611f07",
      "displayName": "spend_by_tag",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_org_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name\n  FROM\n    system.billing.usage t1\n    LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n),\ntagraw as (\n  select\n    workspace_id,\n    usage_metadata.job_id as job_id,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(t1.sku_name),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    ifnull(t1.team_name, 'unknown') as team_name,\n    (usage_quantity * list_prices.pricing.default) as list_cost\n  from\n    billing_w_org_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    and t1.usage_metadata.job_id IS NOT NULL\n    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY\n),\ntagspend as (\n  select\n    workspace_id,\n    job_id,\n    job_type_from_sku,\n    team_name as tagbucket,\n    sum(list_cost) as list_cost\n  from\n    tagraw\n  group by\n    ALL\n)\nselect\n  t1.*,\n  t3.workspace_name,\n  coalesce(t4.name, t1.job_id) as job_name\nfrom\n  tagspend t1\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t4 USING (workspace_id, job_id);"
    },
    {
      "name": "12c6b9d3",
      "displayName": "highest_change_jobs_in_period",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_jobs_w_org_team as (\n  SELECT\n    workspace_id,\n    job_id,\n    ifnull(max(team_name), 'unknown') as team_name\n  FROM\n    (\n      SELECT\n        coalesce(t1.workspace_id, t2.workspace_id) as workspace_id,\n        coalesce(t1.usage_metadata.job_id, t2.job_id) as job_id,\n        {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name\n      FROM\n        system.billing.usage t1 FULL\n        OUTER JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n        AND t1.usage_metadata.job_id = t2.job_id\n    )\n  group by\n    all\n),\njob_run_timeline_with_cost as (\n  SELECT\n    t1.*,\n    t1.usage_metadata.job_id as job_id,\n    t1.identity_metadata.run_as as run_as,\n    t1.usage_quantity * list_prices.pricing.default AS list_cost\n  FROM\n    system.billing.usage t1\n    INNER JOIN system.billing.list_prices list_prices ON t1.cloud = list_prices.cloud\n    AND t1.sku_name = list_prices.sku_name\n    AND t1.usage_start_time >= list_prices.price_start_time\n    AND (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is NULL\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND t1.usage_metadata.job_id IS NOT NULL\n    AND t1.usage_metadata.job_run_id IS NOT NULL\n    AND t1.usage_date >= DATE_ADD(CURRENT_DATE(), -(:number_of_days * 2))\n)\nSELECT\n  coalesce(t2.name, t1.job_id) as job_name,\n  t1.workspace_id,\n  t4.workspace_name,\n  t1.job_id,\n  ifnull(t3.team_name, 'unknown') as team_name,\n  t1.sku_name,\n  ifnull(\n    {catalog}.{schema}.job_type_from_sku(t1.sku_name),\n    'UNKNOWN'\n  ) as job_type_from_sku,\n  t1.run_as,\n  Last7DaySpend as LastPeriodSpend,\n  Last14DaySpend as OlderPeriodSpend,\n  last7DaySpend - last14DaySpend as LastPeriodGrowth,\n  ifnull(\n    try_divide(\n      (last7DaySpend - last14DaySpend),\n      last14DaySpend\n    ) * 100,\n    100\n  ) AS LastPeriodGrowthPct\nFROM\n  (\n    SELECT\n      workspace_id,\n      job_id,\n      run_as,\n      sku_name,\n      SUM(list_cost) AS spend,\n      SUM(\n        CASE\n          WHEN usage_end_time BETWEEN date_add(current_date(), -(:number_of_days))\n          AND date_add(current_date(), -1) THEN list_cost\n          ELSE 0\n        END\n      ) AS Last7DaySpend,\n      SUM(\n        CASE\n          WHEN usage_end_time BETWEEN date_add(current_date(), -(:number_of_days * 2))\n          AND date_add(current_date(), -(:number_of_days + 1)) THEN list_cost\n          ELSE 0\n        END\n      ) AS Last14DaySpend\n    FROM\n      job_run_timeline_with_cost\n    GROUP BY\n      ALL\n  ) t1\n  LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n  LEFT JOIN billing_jobs_w_org_team t3 USING (workspace_id, job_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t4 USING (workspace_id)\nORDER BY\n  LastPeriodGrowth DESC;",
      "parameters": [
        {
          "displayName": "number_of_days",
          "keyword": "number_of_days",
          "dataType": "INTEGER",
          "defaultSelection": {
            "values": {
              "dataType": "INTEGER",
              "values": [
                {
                  "value": "7"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "e4d4c1ff",
      "displayName": "jobs_no_tags",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_data AS (\n  SELECT\n    workspace_id,\n    job_id,\n    list_cost,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name\n  FROM\n    (\n      select\n        t1.workspace_id,\n        t1.usage_metadata.job_id as job_id,\n        t1.usage_quantity * list_prices.pricing.default as list_cost,\n        t1.sku_name,\n        t1.usage_end_time\n      from\n        system.billing.usage t1\n        INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n        and t1.sku_name = list_prices.sku_name\n        and t1.usage_start_time >= list_prices.price_start_time\n        and (\n          t1.usage_end_time <= list_prices.price_end_time\n          or list_prices.price_end_time is null\n        )\n      WHERE\n        t1.billing_origin_product = 'JOBS'\n        and t1.usage_metadata.job_id is not null\n        AND usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    )\n),\nagg_data as (\n  SELECT\n    t1.workspace_id,\n    t1.job_id,\n    SUM(list_cost) as list_cost,\n    FIRST_VALUE(recent_sku_name) AS recent_sku_name\n  FROM\n    billing_data t1\n  group by\n    all\n)\nselect\n  most_recent_jobs.workspace_id,\n  t1.workspace_name,\n  coalesce(name, most_recent_jobs.job_id) as job_name,\n  most_recent_jobs.job_id,\n  sum(list_cost) as list_cost,\n  first(recent_sku_name),\n  ifnull(\n    {catalog}.{schema}.job_type_from_sku(recent_sku_name),\n    'UNKNOWN'\n  ) as job_type_from_sku,\n  any_value(tags) as tags,\n  any_value(run_as) as run_as\nfrom\n  most_recent_jobs\n  LEFT JOIN {catalog}.{schema}.workspace_reference t1 USING (workspace_id)\n  LEFT JOIN agg_data USING (workspace_id, job_id)\nwhere\n  cardinality(tags) = 0\ngroup by\n  all\norder by\n  list_cost desc;"
    },
    {
      "name": "bc463c3f",
      "displayName": "most_expensive_jobs",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_org_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name\n  FROM\n    system.billing.usage t1\n    LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n),\nlist_cost_per_job as (\n  SELECT\n    t1.workspace_id,\n    t1.usage_metadata.job_id,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(t1.sku_name),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    ifnull(t1.team_name, 'unknown') as team_name,\n    COUNT(DISTINCT t1.usage_metadata.job_run_id) as runs,\n    SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n    first(identity_metadata.run_as, true) as run_as,\n    first(t1.custom_tags, true) as custom_tags,\n    MAX(t1.usage_end_time) as usage_end_time\n  FROM\n    billing_w_org_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND t1.usage_metadata.job_id IS NOT NULL\n    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY\n  GROUP BY\n    ALL\n)\nSELECT\n  coalesce(\n    t2.name,\n    t1.job_id\n  ) as job_name,\n  t1.job_id,\n  t1.job_type_from_sku,\n  t1.team_name,\n  t1.workspace_id,\n  t3.workspace_name,\n  t1.runs,\n  t1.run_as,\n  SUM(list_cost) as list_cost,\n  t1.usage_end_time\nFROM\n  list_cost_per_job t1\n  LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\nGROUP BY\n  ALL\nORDER BY\n  list_cost DESC;"
    },
    {
      "name": "8ee7685e",
      "displayName": "job_run_count",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_org_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name\n  FROM\n    system.billing.usage t1\n    LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n)\nSELECT\n  t1.workspace_id,\n  t2.workspace_name,\n  t1.usage_metadata.job_id as job_id,\n  coalesce(t3.name, t1.usage_metadata.job_id) as job_name,\n  ifnull(\n    {catalog}.{schema}.job_type_from_sku(t1.sku_name),\n    'UNKNOWN'\n  ) as job_type_from_sku,\n  ifnull(t1.team_name, 'unknown') as team_name,\n  t1.usage_date,\n  COUNT(t1.usage_metadata.job_run_id) as no_of_runs,\n  t1.identity_metadata.run_as as run_as,\n  t1.usage_quantity * list_prices.pricing.default AS list_cost\nFROM\n  billing_w_org_team t1\n  INNER JOIN system.billing.list_prices list_prices ON t1.cloud = list_prices.cloud\n  AND t1.sku_name = list_prices.sku_name\n  AND t1.usage_start_time >= list_prices.price_start_time\n  AND (\n    t1.usage_end_time <= list_prices.price_end_time\n    or list_prices.price_end_time is NULL\n  )\n  LEFT JOIN {catalog}.{schema}.workspace_reference t2 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t3 ON t1.workspace_id = t3.workspace_id\n  AND t1.usage_metadata.job_id = t3.job_id\nWHERE\n  t1.billing_origin_product = 'JOBS'\n  AND t1.usage_metadata.job_id IS NOT NULL\n  AND t1.usage_metadata.job_run_id IS NOT NULL\ngroup by\n  all;"
    },
    {
      "name": "6e7c6490",
      "displayName": "highest_failure_jobs",
      "query": "with job_run_timeline_with_cost as (\n  SELECT\n    t1.*,\n    t1.identity_metadata.run_as as run_as,\n    t2.job_id,\n    t2.run_id,\n    t2.result_state,\n    t1.usage_quantity * list_prices.pricing.default as list_cost\n  FROM\n    system.billing.usage t1\n    INNER JOIN system.lakeflow.job_run_timeline t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n    AND t1.usage_metadata.job_run_id = t2.run_id\n    AND t1.usage_start_time >= date_trunc(\"Hour\", t2.period_start_time)\n    AND t1.usage_start_time < date_trunc(\"Hour\", t2.period_end_time) + INTERVAL 1 HOUR\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\nmost_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\ncumulative_run_status_cost as (\n  SELECT\n    workspace_id,\n    job_id,\n    run_id,\n    run_as,\n    result_state,\n    usage_end_time,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(\n        {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n      ) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_team_name,\n    SUM(list_cost) OVER (\n      ORDER BY\n        workspace_id,\n        job_id,\n        run_id,\n        usage_end_time ROWS BETWEEN UNBOUNDED PRECEDING\n        AND CURRENT ROW\n    ) AS cumulative_cost\n  FROM\n    (\n      SELECT\n        t1.workspace_id,\n        t1.job_id,\n        run_id,\n        t1.run_as,\n        result_state,\n        usage_end_time,\n        t1.sku_name,\n        t1.list_cost,\n        t1.usage_end_time,\n        t1.custom_tags,\n        t2.tags\n      FROM\n        job_run_timeline_with_cost t1\n        LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n        AND t1.job_id = t2.job_id\n    )\n  ORDER BY\n    workspace_id,\n    job_id,\n    run_id,\n    usage_end_time\n),\ncost_per_status as (\n  SELECT\n    workspace_id,\n    job_id,\n    run_id,\n    run_as,\n    result_state,\n    usage_end_time,\n    recent_sku_name,\n    recent_team_name,\n    cumulative_cost - COALESCE(\n      LAG(cumulative_cost) OVER (\n        ORDER BY\n          workspace_id,\n          job_id,\n          run_id,\n          usage_end_time\n      ),\n      0\n    ) AS result_state_cost\n  FROM\n    cumulative_run_status_cost\n  WHERE\n    result_state IS NOT NULL\n  ORDER BY\n    workspace_id,\n    job_id,\n    run_id,\n    usage_end_time\n),\ncost_per_status_agg as (\n  SELECT\n    workspace_id,\n    job_id,\n    ifnull(first(recent_team_name), 'unknown') as team_name,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(first(recent_sku_name)),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    FIRST(run_as, TRUE) as run_as,\n    SUM(result_state_cost) as list_cost\n  FROM\n    cost_per_status\n  WHERE\n    result_state IN ('ERROR', 'FAILED', 'TIMED_OUT')\n  GROUP BY\n    ALL\n),\nterminal_statues as (\n  SELECT\n    workspace_id,\n    job_id,\n    CASE\n      WHEN result_state IN ('ERROR', 'FAILED', 'TIMED_OUT') THEN 1\n      ELSE 0\n    END as is_failure,\n    period_end_time as last_seen_date\n  FROM\n    system.lakeflow.job_run_timeline\n  WHERE\n    result_state IS NOT NULL\n    AND period_end_time >= CURRENT_DATE() - INTERVAL 30 DAYS\n)\nSELECT\n  coalesce(first(t2.name), t1.job_id) as job_name,\n  t1.workspace_id,\n  t5.workspace_name,\n  t1.job_id,\n  ifnull(first(t3.job_type_from_sku), 'UNKNOWN') as job_type_from_sku,\n  ifnull(first(t3.team_name), 'unknown') as team_name,\n  COUNT(*) as runs,\n  t3.run_as,\n  SUM(is_failure) as failures,\n  (\n    1 - COALESCE(try_divide(SUM(is_failure), COUNT(*)), 0)\n  ) * 100 as success_ratio,\n  first(t3.list_cost) as failure_list_cost,\n  MAX(t1.last_seen_date) as last_seen_date\nFROM\n  terminal_statues t1\n  LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n  LEFT JOIN cost_per_status_agg t3 USING (workspace_id, job_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t5 USING (workspace_id)\nGROUP BY\n  ALL\nORDER BY\n  failures DESC;"
    },
    {
      "name": "a166c847",
      "displayName": "most_retry_jobs",
      "query": "with job_run_timeline_with_cost as (\n  SELECT\n    t1.*,\n    t2.job_id,\n    t2.run_id,\n    t1.identity_metadata.run_as as run_as,\n    t2.result_state,\n    t1.usage_quantity * list_prices.pricing.default as list_cost\n  FROM\n    system.billing.usage t1\n    INNER JOIN system.lakeflow.job_run_timeline t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n    AND t1.usage_metadata.job_run_id = t2.run_id\n    AND t1.usage_start_time >= date_trunc(\"Hour\", t2.period_start_time)\n    AND t1.usage_start_time < date_trunc(\"Hour\", t2.period_end_time) + INTERVAL 1 HOUR\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\nmost_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\ncumulative_run_status_cost as (\n  SELECT\n    workspace_id,\n    job_id,\n    run_id,\n    run_as,\n    result_state,\n    usage_end_time,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(\n        {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n      ) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_team_name,\n    SUM(list_cost) OVER (\n      ORDER BY\n        workspace_id,\n        job_id,\n        run_id,\n        usage_end_time ROWS BETWEEN UNBOUNDED PRECEDING\n        AND CURRENT ROW\n    ) AS cumulative_cost\n  FROM\n    (\n      SELECT\n        t1.workspace_id,\n        t1.job_id,\n        run_id,\n        t1.run_as,\n        result_state,\n        usage_end_time,\n        t1.sku_name,\n        t1.list_cost,\n        t1.usage_end_time,\n        t1.custom_tags,\n        t2.tags\n      FROM\n        job_run_timeline_with_cost t1\n        LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n        AND t1.job_id = t2.job_id\n    )\n  ORDER BY\n    workspace_id,\n    job_id,\n    run_id,\n    usage_end_time\n),\ncost_per_status as (\n  SELECT\n    workspace_id,\n    job_id,\n    run_id,\n    run_as,\n    result_state,\n    usage_end_time,\n    recent_sku_name,\n    recent_team_name,\n    cumulative_cost - COALESCE(\n      LAG(cumulative_cost) OVER (\n        ORDER BY\n          workspace_id,\n          job_id,\n          run_id,\n          usage_end_time\n      ),\n      0\n    ) AS result_state_cost\n  FROM\n    cumulative_run_status_cost\n  WHERE\n    result_state IS NOT NULL\n  ORDER BY\n    workspace_id,\n    job_id,\n    run_id,\n    usage_end_time\n),\ncost_per_unsuccesful_status_agg as (\n  SELECT\n    workspace_id,\n    job_id,\n    run_id,\n    ifnull(first(recent_team_name), 'unknown') as team_name,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(first(recent_sku_name)),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    first(run_as, TRUE) as run_as,\n    last(usage_end_time) as usage_end_time,\n    SUM(result_state_cost) as list_cost\n  FROM\n    cost_per_status\n  WHERE\n    result_state != \"SUCCEEDED\"\n  GROUP BY\n    ALL\n),\nrepaired_runs as (\n  SELECT\n    workspace_id,\n    job_id,\n    run_id,\n    COUNT(*) as cnt\n  FROM\n    system.lakeflow.job_run_timeline\n  WHERE\n    result_state IS NOT NULL\n  GROUP BY\n    ALL\n  HAVING\n    cnt > 1\n),\nsuccessful_repairs as (\n  SELECT\n    t1.workspace_id,\n    t1.job_id,\n    t1.run_id,\n    MAX(t1.period_end_time) as period_end_time\n  FROM\n    system.lakeflow.job_run_timeline t1\n    JOIN repaired_runs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.job_id = t2.job_id\n    AND t1.run_id = t2.run_id\n  WHERE\n    t1.result_state = \"SUCCEEDED\"\n  GROUP BY\n    ALL\n),\ncombined_repairs as (\n  SELECT\n    t1.*,\n    t2.period_end_time,\n    t1.cnt as repairs\n  FROM\n    repaired_runs t1\n    LEFT JOIN successful_repairs t2 USING (workspace_id, job_id, run_id)\n)\nSELECT\n  coalesce(last(t3.name), t1.job_id) as job_name,\n  t1.workspace_id,\n  t6.workspace_name,\n  t1.job_id,\n  t1.run_id,\n  max(t2.period_end_time) as last_seen_date,\n  ifnull(first(t4.job_type_from_sku), 'UNKNOWN') as job_type_from_sku,\n  ifnull(first(t4.team_name), 'unknown') as team_name,\n  first(t4.run_as, TRUE) as run_as,\n  first(t1.repairs) - 1 as repairs,\n  first(t4.list_cost) as repair_list_cost,\n  CASE\n    WHEN t1.period_end_time IS NOT NULL THEN CAST(\n      t1.period_end_time - MIN(t2.period_end_time) as LONG\n    )\n    ELSE NULL\n  END AS repair_time_seconds\nFROM\n  combined_repairs t1\n  JOIN system.lakeflow.job_run_timeline t2 USING (workspace_id, job_id, run_id)\n  LEFT JOIN most_recent_jobs t3 USING (workspace_id, job_id)\n  LEFT JOIN cost_per_unsuccesful_status_agg t4 USING (workspace_id, job_id, run_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t6 USING (workspace_id)\nWHERE\n  t2.result_state IS NOT NULL\nGROUP BY\n  t1.workspace_id,\n  t6.workspace_name,\n  t1.job_id,\n  t1.run_id,\n  t1.period_end_time\nORDER BY\n  repairs DESC;"
    },
    {
      "name": "8cd4b39f",
      "displayName": "outlier_job_runs",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name\n  FROM\n    system.billing.usage t1\n    LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n),\nstats_per_job_run as (\n  SELECT\n    t1.workspace_id,\n    t1.usage_metadata.job_id,\n    t1.usage_metadata.job_run_id as run_id,\n    max(t1.team_name) as team_name,\n    SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n    first(t1.sku_name, true) as sku_name,\n    first(identity_metadata.run_as, true) as run_as,\n    first(t1.custom_tags, true) as custom_tags,\n    MAX(t1.usage_end_time) as last_seen,\n    MIN(t1.usage_start_time) as first_seen\n  FROM\n    billing_w_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND t1.usage_metadata.job_id IS NOT NULL\n    AND t1.usage_metadata.job_run_id IS NOT NULL\n    AND t1.usage_start_time >= CURRENT_DATE() - INTERVAL 30 DAY\n  GROUP BY\n    1,\n    2,\n    3\n),\nstats_per_job AS (\n  SELECT\n    workspace_id,\n    job_id,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(sku_name),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    ifnull(max(team_name), 'unknown') as team_name,\n    COUNT(run_id) AS runs,\n    SUM(list_cost) AS total_list_cost,\n    AVG(list_cost) AS avg_list_cost,\n    MAX(list_cost) AS max_list_cost,\n    percentile(list_cost, 0.9) AS p90,\n    last_seen as last_seen_date\n  FROM\n    stats_per_job_run\n  WHERE\n    first_seen > CURRENT_TIMESTAMP() - INTERVAL 30 DAYS\n  GROUP BY\n    ALL\n  ORDER BY\n    total_list_cost DESC\n)\nSELECT\n  t1.*,\n  t2.workspace_name,\n  coalesce(t3.name, t1.job_id) as job_name,\n  (max_list_cost - p90) AS list_cost_deviation_from_p90\nFROM\n  stats_per_job t1\n  LEFT JOIN {catalog}.{schema}.workspace_reference t2 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t3 USING (workspace_id, job_id)\nORDER BY\n  list_cost_deviation_from_p90 DESC;"
    },
    {
      "name": "f5931b7b",
      "displayName": "job_run_workspace_30_days",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_team as (\n  SELECT\n    *,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(\n        {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n      ) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_team_name\n  FROM\n    (\n      SELECT\n        t1.*,\n        t1.usage_metadata.job_id as job_id,\n        t1.sku_name,\n        t1.usage_end_time,\n        t1.custom_tags,\n        t2.tags\n      FROM\n        system.billing.usage t1\n        LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n        AND t1.usage_metadata.job_id = t2.job_id\n    )\n),\njobs_usage_with_list_cost as (\n  SELECT\n    t1.workspace_id,\n    t1.job_id,\n    ifnull(first(recent_team_name), 'unknown') as team_name,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(first(recent_sku_name)),\n      'UNKNOWN'\n    ) as job_type_from_sku\n  FROM\n    billing_w_team t1\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n  group by\n    all\n)\nSELECT\n  t1.workspace_id,\n  t3.workspace_name,\n  t1.job_id,\n  t1.run_id,\n  coalesce(t4.name, t1.job_id) as job_name,\n  ifnull(t2.job_type_from_sku, 'UNKNOWN') as job_type_from_sku,\n  ifnull(t2.team_name, 'unknown') as team_name\nFROM\n  system.lakeflow.job_run_timeline t1\n  LEFT JOIN jobs_usage_with_list_cost t2 USING (workspace_id, job_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t4 USING (workspace_id, job_id)\nWHERE\n  period_start_time >= CURRENT_DATE() - INTERVAL 30 DAYS;"
    },
    {
      "name": "1e4e16c0",
      "displayName": "job_run_w_duration",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name,\n    t1.usage_metadata.job_id as job_id,\n    t1.usage_metadata.job_run_id as run_id\n  FROM\n    system.billing.usage t1\n    LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n  WHERE usage_date between current_date() - INTERVAL 180 DAY and current_date() - INTERVAL 1 DAY\n),\njobs_usage as (\n  SELECT\n    t1.*,\n    FIRST_VALUE(t1.sku_name) OVER (\n      PARTITION BY t1.job_id\n      ORDER BY\n        t1.usage_end_time DESC ROWS BETWEEN UNBOUNDED PRECEDING\n        AND UNBOUNDED FOLLOWING\n    ) AS recent_sku_name,\n    FIRST_VALUE(t1.team_name) OVER (\n      PARTITION BY t1.job_id\n      ORDER BY\n        t1.usage_end_time DESC ROWS BETWEEN UNBOUNDED PRECEDING\n        AND UNBOUNDED FOLLOWING\n    ) AS recent_team_name\n  FROM\n    billing_w_team t1\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n),\nusage_per_job as (\n  SELECT\n    t1.workspace_id,\n    t1.job_id,\n    t1.run_id,\n    FIRST(t1.recent_sku_name) as sku_name,\n    FIRST(t1.recent_team_name) as team_name\n  FROM\n    jobs_usage t1\n  group by\n    all\n),\ndate_ranges AS (\n    SELECT \n        workspace_id,\n        job_id,\n        run_id,\n        CAST(period_start_time AS DATE) AS start_date,\n        CAST(period_end_time AS DATE) AS end_date,\n        period_start_time,\n        period_end_time\n    FROM system.lakeflow.job_run_timeline\n    WHERE period_start_time >= current_date() - INTERVAL 180 DAY\n    and period_end_time <= current_date() - INTERVAL 1 DAY\n),\nexpanded_dates AS (\n    SELECT\n        workspace_id,\n        job_id,\n        run_id,\n        EXPLODE(SEQUENCE(start_date, end_date)) AS job_date,\n        period_start_time,\n        period_end_time\n    FROM date_ranges\n),\njob_durations AS (\n    SELECT \n        workspace_id,\n        job_id,\n        run_id,\n        job_date,\n        CASE \n            WHEN job_date = CAST(period_start_time AS DATE) THEN period_start_time\n            ELSE CAST(job_date AS TIMESTAMP)\n        END AS actual_start_time,\n        CASE \n            WHEN job_date = CAST(period_end_time AS DATE) THEN period_end_time\n            ELSE CAST(job_date AS TIMESTAMP) + INTERVAL 1 DAY - INTERVAL 1 SECOND\n        END AS actual_end_time\n    FROM expanded_dates\n),\ntimed_job_runs AS (\nSELECT \n    workspace_id,\n    job_id,\n    run_id,\n    job_date,\n    UNIX_TIMESTAMP(actual_end_time) - UNIX_TIMESTAMP(actual_start_time) AS duration_in_seconds\nFROM job_durations\n)\nSELECT\n  t1.workspace_id,\n  t3.workspace_name,\n  t1.job_id,\n  t1.run_id,\n  coalesce(t4.name, t1.job_id) as job_name,\n  ifnull(t2.sku_name, 'Unbilled') as sku_name,\n  ifnull(\n    {catalog}.{schema}.job_type_from_sku(t2.sku_name),\n    'UNKNOWN'\n  ) as job_type_from_sku,\n  ifnull(t2.team_name, 'unknown') as team_name,\n  t1.job_date,\n  t1.duration_in_seconds as job_duration_in_secs\nFROM\n  timed_job_runs t1\n  LEFT JOIN usage_per_job t2 USING (workspace_id, job_id, run_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t4 USING (workspace_id, job_id)\nWHERE\n  date(t1.job_date) < current_date();"
    },
    {
      "name": "da68cf08",
      "displayName": "finished_jobs",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_jobs_w_org_team as (\n  SELECT\n    workspace_id,\n    job_id,\n    ifnull(first(recent_team_name), 'unknown') as team_name,\n    first(recent_sku_name) as sku_name\n  FROM\n    (\n      SELECT\n        workspace_id,\n        job_id,\n        case\n          when usage_end_time is null then null\n          else FIRST_VALUE(sku_name) OVER (\n            PARTITION BY job_id\n            ORDER BY\n              usage_end_time DESC\n          )\n        end AS recent_sku_name,\n        case\n          when usage_end_time is null then null\n          else FIRST_VALUE(\n            {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n          ) OVER (\n            PARTITION BY job_id\n            ORDER BY\n              usage_end_time DESC\n          )\n        end AS recent_team_name\n      FROM\n        (\n          select\n            coalesce(t1.workspace_id, t2.workspace_id) as workspace_id,\n            coalesce(t1.usage_metadata.job_id, t2.job_id) as job_id,\n            t1.sku_name,\n            t1.usage_end_time,\n            t1.custom_tags,\n            t2.tags\n          FROM\n            system.billing.usage t1\n            LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n            AND t1.usage_metadata.job_id = t2.job_id\n        )\n    )\n  group by\n    all\n)\nSELECT\n  t1.*,\n  t3.workspace_name,\n  coalesce(t4.name, t1.job_id) as job_name,\n  ifnull(\n    {catalog}.{schema}.job_type_from_sku(t2.sku_name),\n    'UNKNOWN'\n  ) as job_type_from_sku,\n  ifnull(t2.team_name, 'unknown') as team_name,\n  UNIX_TIMESTAMP(t1.period_end_time) - UNIX_TIMESTAMP(t1.period_start_time) as job_duration_in_secs\nFROM\n  system.lakeflow.job_run_timeline t1\n  LEFT JOIN billing_jobs_w_org_team t2 USING (workspace_id, job_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t4 USING (workspace_id, job_id)\nWHERE\n  result_state IS NOT NULL;"
    },
    {
      "name": "9bbfcd27",
      "displayName": "cost_per_status_jobs",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_org_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, t2.tags) as team_name\n  FROM\n    system.billing.usage t1\n    LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n),\njob_run_timeline_with_cost as (\n  SELECT\n    t1.cloud,\n    t1.workspace_id,\n    t2.job_id,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(t1.sku_name),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    ifnull(t1.team_name, 'unknown') as team_name,\n    t2.run_id,\n    t2.result_state,\n    t1.usage_start_time,\n    t1.usage_end_time,\n    t1.sku_name,\n    t1.usage_unit,\n    t1.usage_quantity,\n    t1.usage_quantity * list_prices.pricing.default AS list_cost\n  FROM\n    billing_w_org_team t1\n    INNER JOIN system.lakeflow.job_run_timeline t2 ON t1.workspace_id = t2.workspace_id\n    AND t1.usage_metadata.job_id = t2.job_id\n    AND t1.usage_metadata.job_run_id = t2.run_id\n    AND t1.usage_start_time >= date_trunc(\"Hour\", t2.period_start_time)\n    AND t1.usage_start_time < date_trunc(\"Hour\", t2.period_end_time) + INTERVAL 1 HOUR\n    INNER JOIN system.billing.list_prices list_prices ON t1.cloud = list_prices.cloud\n    AND t1.sku_name = list_prices.sku_name\n    AND t1.usage_start_time >= list_prices.price_start_time\n    AND (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is NULL\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n),\ncumulative_run_status_cost as (\n  SELECT\n    workspace_id,\n    job_id,\n    run_id,\n    result_state,\n    usage_start_time,\n    usage_end_time,\n    job_type_from_sku,\n    team_name,\n    SUM(list_cost) OVER (\n      partition by job_type_from_sku,\n      team_name\n      ORDER BY\n        workspace_id,\n        job_id,\n        run_id,\n        usage_end_time ROWS BETWEEN UNBOUNDED PRECEDING\n        AND CURRENT ROW\n    ) AS cumulative_cost\n  FROM\n    job_run_timeline_with_cost\n  ORDER BY\n    workspace_id,\n    job_id,\n    run_id,\n    usage_end_time\n),\nfinal_data as (\n  SELECT\n    workspace_id,\n    job_id,\n    job_type_from_sku,\n    team_name,\n    run_id,\n    result_state,\n    usage_start_time,\n    usage_end_time,\n    cumulative_cost - COALESCE(\n      LAG(cumulative_cost) OVER (\n        partition by job_type_from_sku,\n        team_name\n        ORDER BY\n          workspace_id,\n          job_id,\n          run_id,\n          usage_end_time\n      ),\n      0\n    ) AS result_state_cost\n  FROM\n    cumulative_run_status_cost\n  WHERE\n    result_state IS NOT NULL\n)\nselect\n  t1.*,\n  t2.workspace_name,\n  coalesce(t4.name, t1.job_id) as job_name\nfrom\n  final_data t1\n  LEFT JOIN {catalog}.{schema}.workspace_reference t2 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t4 USING (workspace_id, job_id)\nORDER BY\n  workspace_id,\n  job_id,\n  run_id,\n  usage_end_time;"
    },
    {
      "name": "fe4804e7",
      "displayName": "longest_running_jobs_t30",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_jobs_w_org_team as (\n  SELECT\n    workspace_id,\n    job_id,\n    ifnull(first(recent_team_name), 'unknown') as team_name,\n    first(recent_sku_name) as sku_name\n  FROM\n    (\n      SELECT\n        workspace_id,\n        job_id,\n        case\n          when usage_end_time is null then null\n          else FIRST_VALUE(sku_name) OVER (\n            PARTITION BY job_id\n            ORDER BY\n              usage_end_time DESC\n          )\n        end AS recent_sku_name,\n        case\n          when usage_end_time is null then null\n          else FIRST_VALUE(\n            {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n          ) OVER (\n            PARTITION BY job_id\n            ORDER BY\n              usage_end_time DESC\n          )\n        end AS recent_team_name\n      FROM\n        (\n          select\n            coalesce(t1.workspace_id, t2.workspace_id) as workspace_id,\n            coalesce(t1.usage_metadata.job_id, t2.job_id) as job_id,\n            t1.sku_name,\n            t1.usage_end_time,\n            t1.custom_tags,\n            t2.tags\n          FROM\n            system.billing.usage t1\n            LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n            AND t1.usage_metadata.job_id = t2.job_id\n        )\n    )\n  group by\n    all\n),\njob_run_duration as (\n  SELECT\n    workspace_id,\n    job_id,\n    run_id,\n    CAST(SUM(period_end_time - period_start_time) AS LONG) as duration\n  FROM\n    system.lakeflow.job_run_timeline\n  WHERE\n    period_start_time > CURRENT_TIMESTAMP() - INTERVAL 30 DAYS\n  GROUP BY\n    ALL\n)\nSELECT\n  t1.workspace_id,\n  t1.job_id,\n  t3.workspace_name,\n  coalesce(t4.name, t1.job_id) as job_name,\n  ifnull(\n    {catalog}.{schema}.job_type_from_sku(t2.sku_name),\n    'UNKNOWN'\n  ) as job_type_from_sku,\n  ifnull(t2.team_name, 'unknown') as team_name,\n  COUNT(DISTINCT t1.run_id) as runs,\n  MEAN(t1.duration) as mean_seconds,\n  AVG(t1.duration) as avg_seconds,\n  PERCENTILE(t1.duration, 0.9) as p90_seconds,\n  PERCENTILE(t1.duration, 0.95) as p95_seconds\nFROM\n  job_run_duration t1\n  LEFT JOIN billing_jobs_w_org_team t2 USING (workspace_id, job_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN most_recent_jobs t4 USING (workspace_id, job_id)\nGROUP BY\n  ALL\nORDER BY\n  mean_seconds DESC\nLIMIT\n  10;"
    },
    {
      "name": "9f1b61ef",
      "displayName": "job_cpu_mem",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_org_team as (\n  SELECT\n    *,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(\n        {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n      ) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_team_name\n  FROM\n    (\n      SELECT\n        t1.*,\n        t1.usage_metadata.job_id as job_id,\n        t1.sku_name,\n        t1.usage_end_time,\n        t1.custom_tags,\n        t2.tags\n      FROM\n        system.billing.usage t1\n        LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n        AND t1.usage_metadata.job_id = t2.job_id\n    )\n),\nlist_cost_per_job_cluster as (\n  SELECT\n    t1.workspace_id,\n    t1.usage_metadata.job_id,\n    t1.usage_metadata.cluster_id,\n    first(t1.recent_team_name) as team_name,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(first(t1.recent_sku_name)),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    COUNT(DISTINCT t1.usage_metadata.job_run_id) as runs,\n    SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n    first(identity_metadata.run_as, true) as run_as,\n    first(t1.custom_tags, true) as custom_tags,\n    MAX(t1.usage_end_time) as last_seen_date\n  FROM\n    billing_w_org_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND t1.usage_metadata.job_id IS NOT NULL\n    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY\n  GROUP BY\n    ALL\n),\njobsrollingmonth as (\n  SELECT\n    t2.name,\n    t1.job_id,\n    t1.workspace_id,\n    t1.cluster_id,\n    ifnull(first(t1.team_name), 'unknown') as team_name,\n    ifnull(first(t1.job_type_from_sku), 'UNKNOWN') as job_type_from_sku,\n    t1.runs,\n    t1.run_as,\n    SUM(list_cost) as list_cost,\n    t1.last_seen_date\n  FROM\n    list_cost_per_job_cluster t1\n    LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n  GROUP BY\n    ALL\n  ORDER BY\n    list_cost DESC\n),\nclusterutil as (\n  SELECT\n    *\n  from\n    system.compute.node_timeline\n  WHERE\n    start_time >= CURRENT_DATE() - INTERVAL 30 DAY\n),\njobswithutil as (\n  select\n    jobsrollingmonth.workspace_id,\n    jobsrollingmonth.job_id,\n    coalesce(jobsrollingmonth.name, jobsrollingmonth.job_id) as job_name,\n    max(jobsrollingmonth.team_name) as team_name,\n    max(jobsrollingmonth.job_type_from_sku) as job_type_from_sku,\n    avg(cpu_user_percent + cpu_system_percent) as `Avg CPU Utilization`,\n    100 - avg(cpu_user_percent + cpu_system_percent) as `Avg Unutilized CPU`,\n    max(cpu_user_percent + cpu_system_percent) as `Peak CPU Utilization`,\n    avg(cpu_wait_percent) as `Avg CPU Disk Wait`,\n    max(cpu_wait_percent) as `Max CPU Disk Wait`,\n    avg(mem_used_percent) as `Avg Memory Utilization`,\n    max(mem_used_percent) as `Max Memory Utilization`\n  from\n    clusterutil\n    join jobsrollingmonth on clusterutil.cluster_id = jobsrollingmonth.cluster_id\n  where\n    jobsrollingmonth.name is not null\n  group by\n    1,\n    2,\n    3\n)\nselect\n  t1.*,\n  t3.workspace_name\nfrom\n  jobswithutil t1\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\norder by\n  `Avg Memory Utilization`;"
    },
    {
      "name": "9738c1b0",
      "displayName": "job_no_scaling",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_team as (\n  SELECT\n    *,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(\n        {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n      ) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_team_name\n  FROM\n    (\n      SELECT\n        t1.*,\n        t1.usage_metadata.job_id as job_id,\n        t1.sku_name,\n        t1.usage_end_time,\n        t1.custom_tags,\n        t2.tags\n      FROM\n        system.billing.usage t1\n        LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n        AND t1.usage_metadata.job_id = t2.job_id\n    )\n),\nlist_cost_per_job_cluster as (\n  SELECT\n    t1.workspace_id,\n    t1.usage_metadata.job_id,\n    t1.usage_metadata.cluster_id,\n    first(t1.recent_team_name) as team_name,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(first(t1.recent_sku_name)),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    COUNT(DISTINCT t1.usage_metadata.job_run_id) as runs,\n    SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n    first(identity_metadata.run_as, true) as run_as,\n    first(t1.custom_tags, true) as custom_tags,\n    MAX(t1.usage_end_time) as last_seen_date\n  FROM\n    billing_w_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND t1.usage_metadata.job_id IS NOT NULL\n    AND t1.usage_metadata.cluster_id IS NOT NULL\n    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY\n  GROUP BY\n    ALL\n),\njob_runs_enhanced as (\n  SELECT\n    t2.name,\n    t1.job_id,\n    t1.workspace_id,\n    t1.cluster_id,\n    max(t1.team_name) as team_name,\n    max(t1.job_type_from_sku) as job_type_from_sku,\n    t1.runs,\n    t1.run_as,\n    SUM(list_cost) as list_cost,\n    t1.last_seen_date\n  FROM\n    list_cost_per_job_cluster t1\n    LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n  GROUP BY\n    ALL\n  ORDER BY\n    list_cost DESC\n),\nclusters as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      cluster_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.compute.clusters\n  WHERE\n    cluster_source = \"JOB\" QUALIFY rn = 1\n)\nSELECT\n  clusters.workspace_id,\n  t1.workspace_name,\n  jobs.job_id,\n  coalesce(first(jobs.name), jobs.job_id) as job_name,\n  first(jobs.run_as) as run_as,\n  ifnull(max(jobs.team_name), 'unknown') as team_name,\n  ifnull(max(jobs.job_type_from_sku), 'UNKNOWN') as job_type_from_sku,\n  SUM(jobs.list_cost) as list_cost,\n  first(worker_count) as worker_count,\n  first(min_autoscale_workers) as min_autoscale_workers,\n  first(max_autoscale_workers) as max_autoscale_workers\nFROM\n  clusters\n  JOIN job_runs_enhanced jobs USING(workspace_id, cluster_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t1 USING (workspace_id)\nWHERE\n  (\n    min_autoscale_workers is NULL\n    OR max_autoscale_workers is NULL\n  )\n  and worker_count > 1\nGROUP BY\n  1,\n  2,\n  3\nORDER BY\n  list_cost DESC;"
    },
    {
      "name": "9cc64b3d",
      "displayName": "job_low_dbr",
      "query": "with most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_w_team as (\n  SELECT\n    *,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(\n        {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n      ) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_team_name\n  FROM\n    (\n      SELECT\n        t1.*,\n        t1.usage_metadata.job_id as job_id,\n        t1.sku_name,\n        t1.usage_end_time,\n        t1.custom_tags,\n        t2.tags\n      FROM\n        system.billing.usage t1\n        LEFT JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n        AND t1.usage_metadata.job_id = t2.job_id\n    )\n),\nlist_cost_per_job_cluster as (\n  SELECT\n    t1.workspace_id,\n    t1.usage_metadata.job_id,\n    t1.usage_metadata.cluster_id,\n    first(t1.recent_team_name) as team_name,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(first(t1.recent_sku_name)),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    COUNT(DISTINCT t1.usage_metadata.job_run_id) as runs,\n    SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n    first(identity_metadata.run_as, true) as run_as,\n    first(t1.custom_tags, true) as custom_tags,\n    MAX(t1.usage_end_time) as last_seen_date\n  FROM\n    billing_w_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'JOBS'\n    AND t1.usage_metadata.job_id IS NOT NULL\n    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY\n  GROUP BY\n    ALL\n),\njobsrollingmonth as (\n  SELECT\n    t2.name,\n    t1.job_id,\n    t1.workspace_id,\n    t1.cluster_id,\n    max(t1.team_name) as team_name,\n    max(t1.job_type_from_sku) as job_type_from_sku,\n    t1.runs,\n    t1.run_as,\n    SUM(list_cost) as list_cost,\n    t1.last_seen_date\n  FROM\n    list_cost_per_job_cluster t1\n    LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n  GROUP BY\n    ALL\n  ORDER BY\n    list_cost DESC\n),\nclusters as (\n  SELECT\n    *\n  from\n    system.compute.clusters\n  WHERE\n    delete_time is not null\n)\nselect\n  clusters.workspace_id,\n  t1.workspace_name,\n  coalesce(jobsrollingmonth.name, jobsrollingmonth.job_id) as job_name,\n  jobsrollingmonth.job_id,\n  jobsrollingmonth.run_as,\n  ifnull(max(jobsrollingmonth.team_name), 'unknown') as team_name,\n  ifnull(max(jobsrollingmonth.job_type_from_sku), 'UNKNOWN') as job_type_from_sku,\n  sum(jobsrollingmonth.list_cost),\n  any_value(dbr_Version)\nfrom\n  clusters\n  join jobsrollingmonth on clusters.cluster_id = jobsrollingmonth.cluster_id\n  LEFT JOIN {catalog}.{schema}.workspace_reference t1 USING (workspace_id)\nwhere\n  left(dbr_version, 2) < 11.3\ngroup by\n  1,\n  2,\n  3,\n  4,\n  5;"
    },
    {
      "name": "747b8e0e",
      "displayName": "jobs_ap_clusters",
      "query": "with clusters AS (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      cluster_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.compute.clusters\n  WHERE\n    cluster_source = \"UI\" QUALIFY rn = 1\n),\njob_tasks_exploded AS (\n  SELECT\n    workspace_id,\n    job_id,\n    EXPLODE(compute_ids) as cluster_id\n  FROM\n    system.lakeflow.job_task_run_timeline\n  WHERE\n    period_start_time >= CURRENT_DATE() - INTERVAL 30 DAY\n),\nall_purpose_cluster_jobs AS (\n  SELECT\n    t1.*,\n    t2.cluster_name,\n    t2.owned_by,\n    t2.dbr_version\n  FROM\n    job_tasks_exploded t1\n    INNER JOIN clusters t2 USING (workspace_id, cluster_id)\n),\nmost_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\nbilling_jobs_w_org_team as (\n  SELECT\n    workspace_id,\n    job_id,\n    ifnull(first(recent_team_name), 'unknown') as team_name,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(first(recent_sku_name)),\n      'UNKNOWN'\n    ) as job_type_from_sku\n  FROM\n    (\n      SELECT\n        workspace_id,\n        job_id,\n        case\n          when usage_end_time is null then null\n          else FIRST_VALUE(sku_name) OVER (\n            PARTITION BY job_id\n            ORDER BY\n              usage_end_time DESC\n          )\n        end AS recent_sku_name,\n        case\n          when usage_end_time is null then null\n          else FIRST_VALUE(\n            {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n          ) OVER (\n            PARTITION BY job_id\n            ORDER BY\n              usage_end_time DESC\n          )\n        end AS recent_team_name\n      FROM\n        (\n          select\n            coalesce(t1.workspace_id, t2.workspace_id) as workspace_id,\n            coalesce(t1.usage_metadata.job_id, t2.job_id) as job_id,\n            t1.sku_name,\n            t1.usage_end_time,\n            t1.custom_tags,\n            t2.tags\n          FROM\n            system.billing.usage t1 FULL\n            OUTER JOIN most_recent_jobs t2 ON t1.workspace_id = t2.workspace_id\n            AND t1.usage_metadata.job_id = t2.job_id\n        )\n    )\n  group by\n    all\n)\nSELECT\n  t1.workspace_id,\n  t4.workspace_name,\n  t1.job_id,\n  coalesce(first(t2.name, TRUE), t1.job_id) as job_name,\n  ifnull(first(t3.team_name), 'unknown') as team_name,\n  ifnull(first(t3.job_type_from_sku), 'UNKNOWN') as job_type_from_sku,\n  array_size(collect_list(t1.cluster_id)) as task_runs,\n  collect_set(\n    named_struct(\n      'cluster_id',\n      t1.cluster_id,\n      'cluster_name',\n      t1.cluster_name\n    )\n  ) as clusters_list\nFROM\n  all_purpose_cluster_jobs t1\n  LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n  LEFT JOIN billing_jobs_w_org_team t3 USING (workspace_id, job_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t4 USING (workspace_id)\nGROUP BY\n  t1.workspace_id,\n  t4.workspace_name,\n  t1.job_id\nORDER BY\n  task_runs DESC;"
    },
    {
      "name": "38f9cb3c",
      "displayName": "stale_datasets",
      "query": "WITH most_recent_jobs as (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) as rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\njob_billing AS (\n  SELECT\n    workspace_id,\n    workspace_name,\n    job_id,\n    job_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(\n        {catalog}.{schema}.team_name_from_tags(custom_tags, tags)\n      ) OVER (\n        PARTITION BY job_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_team_name,\n    usage_date,\n    list_cost\n  FROM\n    (\n      select\n        t1.workspace_id,\n        t2.workspace_name,\n        t1.usage_metadata.job_id as job_id,\n        coalesce(t3.name, t1.usage_metadata.job_id) as job_name,\n        t1.usage_quantity * list_prices.pricing.default as list_cost,\n        t1.sku_name,\n        t1.usage_end_time,\n        t1.usage_date,\n        custom_tags,\n        tags\n      from\n        system.billing.usage t1\n        INNER JOIN system.billing.list_prices list_prices ON t1.cloud = list_prices.cloud\n        AND t1.sku_name = list_prices.sku_name\n        AND t1.usage_start_time >= list_prices.price_start_time\n        AND (\n          t1.usage_end_time <= list_prices.price_end_time\n          or list_prices.price_end_time is NULL\n        )\n        LEFT JOIN {catalog}.{schema}.workspace_reference t2 USING (workspace_id)\n        LEFT JOIN most_recent_jobs t3 ON t1.workspace_id = t3.workspace_id\n        AND t1.usage_metadata.job_id = t3.job_id\n      WHERE\n        t1.billing_origin_product = 'JOBS'\n        and t1.usage_metadata.job_id is not null\n        AND usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    )\n),\nagg_cost AS (\n  SELECT\n    t1.workspace_id,\n    t1.workspace_name,\n    t1.job_id,\n    t1.job_name,\n    ifnull(first(recent_team_name), 'unknown') as team_name,\n    ifnull(\n      {catalog}.{schema}.job_type_from_sku(first(recent_sku_name)),\n      'UNKNOWN'\n    ) as job_type_from_sku,\n    sum(list_cost) as list_cost\n  FROM\n    job_billing t1\n  GROUP BY\n    ALL\n),\nread_tables AS (\n  SELECT\n    DISTINCT source_table_full_name AS used_dataset\n  FROM\n    system.access.table_lineage\n  WHERE\n    source_table_full_name IS NOT NULL\n    AND event_date > CURRENT_DATE() - INTERVAL 30 DAY\n),\njob_tables AS (\n  SELECT\n    workspace_id,\n    entity_id as job_id,\n    created_by,\n    target_table_full_name AS dataset,\n    CASE\n      WHEN target_table_full_name IN (\n        SELECT\n          used_dataset\n        FROM\n          read_tables\n      ) THEN 'used_datasets'\n      ELSE 'unused_datasets'\n    END AS dataset_status\n  FROM\n    system.access.table_lineage\n  WHERE\n    target_table_full_name IS NOT NULL\n    AND entity_type = 'JOB'\n    AND entity_id IS NOT NULL\n    AND entity_id <> ''\n    AND event_date > CURRENT_DATE() - INTERVAL 30 DAY\n),\ndataset_array AS (\n  SELECT\n    workspace_id,\n    job_id,\n    ARRAY_DISTINCT(COLLECT_LIST(created_by)) AS created_by,\n    ARRAY_DISTINCT(\n      COLLECT_LIST(\n        CASE\n          WHEN dataset_status = 'used_datasets' THEN dataset\n        END\n      )\n    ) AS used_datasets,\n    ARRAY_DISTINCT(\n      COLLECT_LIST(\n        CASE\n          WHEN dataset_status = 'unused_datasets' THEN dataset\n        END\n      )\n    ) AS unused_datasets\n  FROM\n    job_tables\n  GROUP BY\n    all\n),\nfinal_data AS (\n  SELECT\n    t1.*,\n    t2.workspace_name,\n    t2.job_name,\n    ifnull(t2.team_name, 'unknown') as team_name,\n    ifnull(t2.job_type_from_sku, 'UNKNOWN') as job_type_from_sku,\n    t2.list_cost,\n    size(t1.unused_datasets) as no_of_unused_datasets\n  from\n    dataset_array t1\n    LEFT JOIN agg_cost t2 USING (workspace_id, job_id)\n)\nselect\n  *\nfrom\n  final_data\nwhere\n  no_of_unused_datasets > 0\n  and list_cost IS NOT NULL\norder by\n  list_cost desc;"
    }
  ],
  "pages": [
    {
      "name": "3c10256d",
      "displayName": "New Page",
      "layout": [
        {
          "widget": {
            "name": "6064a1e4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "sum(Last30to60DaySpend)",
                      "expression": "SUM(`Last30to60DaySpend`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(Last30to60DaySpend)",
                  "displayName": "Sum of Last30to60DaySpend"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Previous 30 Day $list Spend",
                "showDescription": true,
                "description": "Spend in the prior 30 days (i.e., days 31\u201360 before the current date)"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 17,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "8db952ae",
            "queries": [
              {
                "name": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc17e69c7009c4b167331e_usage_date",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "usage_date_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc1838bdb527766f27a00a_usage_date",
                "query": {
                  "datasetName": "8ee7685e",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "usage_date_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc1875a3ca8b3f6c38bf37_job_date",
                "query": {
                  "datasetName": "1e4e16c0",
                  "fields": [
                    {
                      "name": "job_date",
                      "expression": "`job_date`"
                    },
                    {
                      "name": "job_date_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc1881ba741596524f41b0_period_end_time",
                "query": {
                  "datasetName": "da68cf08",
                  "fields": [
                    {
                      "name": "period_end_time",
                      "expression": "`period_end_time`"
                    },
                    {
                      "name": "period_end_time_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc188ca0fbf01a00ba4b21_usage_end_time",
                "query": {
                  "datasetName": "9bbfcd27",
                  "fields": [
                    {
                      "name": "usage_end_time",
                      "expression": "`usage_end_time`"
                    },
                    {
                      "name": "usage_end_time_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "usage_date",
                    "displayName": "usage_date",
                    "queryName": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc17e69c7009c4b167331e_usage_date"
                  },
                  {
                    "fieldName": "usage_date",
                    "displayName": "usage_date",
                    "queryName": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc1838bdb527766f27a00a_usage_date"
                  },
                  {
                    "fieldName": "job_date",
                    "displayName": "job_date",
                    "queryName": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc1875a3ca8b3f6c38bf37_job_date"
                  },
                  {
                    "fieldName": "period_end_time",
                    "displayName": "period_end_time",
                    "queryName": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc1881ba741596524f41b0_period_end_time"
                  },
                  {
                    "fieldName": "usage_end_time",
                    "displayName": "usage_end_time",
                    "queryName": "dashboards/01ef9641cdd8191099b62856082e0945/datasets/01ef9641cddc188ca0fbf01a00ba4b21_usage_end_time"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATETIME",
                    "min": {
                      "value": "now-30d/d"
                    },
                    "max": {
                      "value": "now-1d/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Date Range",
                "showDescription": false
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "20d6788a",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "daily(usage_end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `usage_end_time`)"
                    },
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(usage_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "date"
                },
                "y": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "$list"
                  },
                  "displayName": "$DBU"
                },
                "color": {
                  "fieldName": "sku_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "sku_name"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Daily $list by SKU",
                "showDescription": true,
                "description": "Daily spend per SKU (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 21,
            "width": 4,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "a89a7010",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "daily(usage_end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `usage_end_time`)"
                    },
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(usage_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "date"
                },
                "y": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "$list"
                  },
                  "displayName": "$DBU"
                },
                "color": {
                  "fieldName": "workspace_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "workspace_name"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Daily $list by Workspace",
                "showDescription": true,
                "description": "Daily spend per workspace (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 25,
            "width": 6,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "9e95503d",
            "queries": [
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_workspace_name",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_workspace_name",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e196eb9f4b61cdc524557_workspace_name",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_workspace_name",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e1a28b3d63ba275c2c068_workspace_name",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_workspace_name",
                "query": {
                  "datasetName": "bc463c3f",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_workspace_name",
                "query": {
                  "datasetName": "8ee7685e",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_workspace_name",
                "query": {
                  "datasetName": "6e7c6490",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_workspace_name",
                "query": {
                  "datasetName": "a166c847",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_workspace_name",
                "query": {
                  "datasetName": "8cd4b39f",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_workspace_name",
                "query": {
                  "datasetName": "f5931b7b",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_workspace_name",
                "query": {
                  "datasetName": "1e4e16c0",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_workspace_name",
                "query": {
                  "datasetName": "da68cf08",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_workspace_name",
                "query": {
                  "datasetName": "9bbfcd27",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_workspace_name",
                "query": {
                  "datasetName": "fe4804e7",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_workspace_name",
                "query": {
                  "datasetName": "9f1b61ef",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_workspace_name",
                "query": {
                  "datasetName": "9738c1b0",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_workspace_name",
                "query": {
                  "datasetName": "9cc64b3d",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_workspace_name",
                "query": {
                  "datasetName": "747b8e0e",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e196eb9f4b61cdc524557_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e1a28b3d63ba275c2c068_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_workspace_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace Name"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 10,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "07ff9fe2",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "sum(Last30DaySpend)",
                      "expression": "SUM(`Last30DaySpend`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(Last30DaySpend)",
                  "displayName": "Sum of Last30DaySpend"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30 Day $list Spend",
                "showDescription": true,
                "description": "Spend in the last 30 days"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 17,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "0a7f14c8",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "bb7e5c78",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    },
                    {
                      "name": "weekly_growth",
                      "expression": "`weekly_growth`"
                    },
                    {
                      "name": "3_months_growth_moving_avg",
                      "expression": "`3_months_growth_moving_avg`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "combo",
              "encodings": {
                "x": {
                  "fieldName": "week_start",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "week_start"
                },
                "y": {
                  "primary": {
                    "fields": [
                      {
                        "fieldName": "weekly_growth",
                        "displayName": "weekly %change"
                      }
                    ]
                  },
                  "secondary": {
                    "fields": [
                      {
                        "fieldName": "3_months_growth_moving_avg",
                        "displayName": "3_months_growth_moving_avg"
                      }
                    ]
                  },
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "WoW $list %change",
                "showDescription": true,
                "description": "Week over Week change in job cost percentage (y-axis) with time (x-axis)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 17,
            "width": 4,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "e8fc41c4",
            "textbox_spec": "### Jobs Cost, Operational, and Cluster Performance Dashboard\n----\nThis comprehensive dashboard provides insights into job costs, operations, and resource utilization, enabling teams to monitor, analyze, and optimize job-related performance and spending. The dashboard is organized into four sections, each enhanced by global filters that apply across all sections, allowing for customized and granular analysis.\n\n#### Dashboard Filters\n\n- **Date Range**: Select a specific date range to focus on recent or historical job activity and spending, enabling flexible time-based analysis across costs, operations, and resource usage.\n\n- **Workspace Name**: Filter by workspace to view job-related metrics specific to individual workspaces, giving teams a clear view of workspace-level job activity and cost impact.\n\n- **Job Type**: Narrow down the data by specific job SKU types (e.g., serverless or classic) to analyze cost and performance variations based on job SKU type.\n\n- **Job ID and Job Name**: Filter data by job ID or job name to analyze metrics specific to individual jobs, allowing for detailed troubleshooting or performance review of particular workflows.\n\n- **Team Name**: Filter by team to attribute job costs, resource usage, and operational insights to specific teams, aiding in accountability and team-based optimization efforts.\n\n#### Dashboard Sections\n\n1. **Cost Breakdown and Usage Analysis**: Visualizations and tables providing daily job-related cost breakdowns by workspace, SKU, team, and user, along with insights on high-cost jobs. This section helps track spending patterns and identify major cost drivers.\n\n2. **Cost Comparison and Change Analysis**: Enables cost comparison over customizable timeframes, providing insights into recent changes and job-level cost fluctuations for more targeted cost management.\n\n3. **Operational Analysis**: Visuals of job run counts, run times, and failure rates across different dimensions, offering insights into operational efficiency, job success rates, and patterns in job execution across teams and triggers.\n\n4. **Cluster Analysis**: Resource utilization metrics, including CPU and memory usage, peak utilization by job, and jobs with outdated configurations, supporting efficient cluster management and configuration optimization.\n\nTogether, these sections and filters provide a holistic view of job performance, costs, and resource utilization, empowering teams to make data-driven decisions to optimize job configurations, reduce operational costs, and enhance overall performance.\n\n#### System Tables Used\n- system.billing.usage\n- system.billing.list_prices\n- system.lakeflow.jobs\n- system.lakeflow.job_run_timeline\n- system.compute.clusters\n- system.access.table_lineage\n\n"
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 10
          }
        },
        {
          "widget": {
            "name": "3ae9678c",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    },
                    {
                      "name": "tagbucket",
                      "expression": "`tagbucket`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of list_cost"
                },
                "color": {
                  "fieldName": "tagbucket",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "ohhla",
                        "color": "#AB4057"
                      },
                      {
                        "value": "unknown",
                        "color": "#919191"
                      }
                    ]
                  },
                  "displayName": "tagbucket"
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Rolling t30 $list by Team",
                "showDescription": true,
                "description": "Cost per team name tag attributed by jobs"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 19,
            "width": 2,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "ce1f6f7a",
            "queries": [
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_job_type_from_sku",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_job_type_from_sku",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e196eb9f4b61cdc524557_job_type_from_sku",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_job_type_from_sku",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e1a28b3d63ba275c2c068_job_type_from_sku",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_job_type_from_sku",
                "query": {
                  "datasetName": "bc463c3f",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_job_type_from_sku",
                "query": {
                  "datasetName": "8ee7685e",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_job_type_from_sku",
                "query": {
                  "datasetName": "6e7c6490",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_job_type_from_sku",
                "query": {
                  "datasetName": "a166c847",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_job_type_from_sku",
                "query": {
                  "datasetName": "8cd4b39f",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_job_type_from_sku",
                "query": {
                  "datasetName": "f5931b7b",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_job_type_from_sku",
                "query": {
                  "datasetName": "1e4e16c0",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_job_type_from_sku",
                "query": {
                  "datasetName": "da68cf08",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_job_type_from_sku",
                "query": {
                  "datasetName": "9bbfcd27",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_job_type_from_sku",
                "query": {
                  "datasetName": "fe4804e7",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_job_type_from_sku",
                "query": {
                  "datasetName": "9f1b61ef",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_job_type_from_sku",
                "query": {
                  "datasetName": "9738c1b0",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_job_type_from_sku",
                "query": {
                  "datasetName": "9cc64b3d",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_job_type_from_sku",
                "query": {
                  "datasetName": "747b8e0e",
                  "fields": [
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "job_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e196eb9f4b61cdc524557_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e1a28b3d63ba275c2c068_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_job_type_from_sku"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "displayName": "job_type_from_sku",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_job_type_from_sku"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Job Type"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 10,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "c70af7db",
            "queries": [
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_team_name",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_team_name",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_team_name",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_team_name",
                "query": {
                  "datasetName": "bc463c3f",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_team_name",
                "query": {
                  "datasetName": "8ee7685e",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_team_name",
                "query": {
                  "datasetName": "6e7c6490",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_team_name",
                "query": {
                  "datasetName": "a166c847",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_team_name",
                "query": {
                  "datasetName": "8cd4b39f",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_team_name",
                "query": {
                  "datasetName": "f5931b7b",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_team_name",
                "query": {
                  "datasetName": "1e4e16c0",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_team_name",
                "query": {
                  "datasetName": "da68cf08",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_team_name",
                "query": {
                  "datasetName": "9bbfcd27",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_team_name",
                "query": {
                  "datasetName": "fe4804e7",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_team_name",
                "query": {
                  "datasetName": "9f1b61ef",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_team_name",
                "query": {
                  "datasetName": "9738c1b0",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_team_name",
                "query": {
                  "datasetName": "9cc64b3d",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_team_name",
                "query": {
                  "datasetName": "747b8e0e",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_team_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Team Name"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 11,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "e021dd13",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "weekly(usage_end_time)",
                      "expression": "DATE_TRUNC(\"WEEK\", `usage_end_time`)"
                    },
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "weekly(usage_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "usage_end_time"
                },
                "y": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of list_cost"
                },
                "color": {
                  "fieldName": "team_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "team_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Weekly $list by Tag",
                "description": "Daily spend per team (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 29,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "30d409da",
            "queries": [
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_job_id",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_job_id",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e196eb9f4b61cdc524557_job_id",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_job_id",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e1a28b3d63ba275c2c068_job_id",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_job_id",
                "query": {
                  "datasetName": "bc463c3f",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_job_id",
                "query": {
                  "datasetName": "8ee7685e",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_job_id",
                "query": {
                  "datasetName": "6e7c6490",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_job_id",
                "query": {
                  "datasetName": "a166c847",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_job_id",
                "query": {
                  "datasetName": "8cd4b39f",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_job_id",
                "query": {
                  "datasetName": "f5931b7b",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_job_id",
                "query": {
                  "datasetName": "1e4e16c0",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_job_id",
                "query": {
                  "datasetName": "da68cf08",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_job_id",
                "query": {
                  "datasetName": "9bbfcd27",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_job_id",
                "query": {
                  "datasetName": "fe4804e7",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_job_id",
                "query": {
                  "datasetName": "9f1b61ef",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_job_id",
                "query": {
                  "datasetName": "9738c1b0",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_job_id",
                "query": {
                  "datasetName": "9cc64b3d",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_job_id",
                "query": {
                  "datasetName": "747b8e0e",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e196eb9f4b61cdc524557_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e1a28b3d63ba275c2c068_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_job_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Job Id"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 11,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "09f72163",
            "queries": [
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_job_name",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_job_name",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e196eb9f4b61cdc524557_job_name",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_job_name",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e1a28b3d63ba275c2c068_job_name",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_job_name",
                "query": {
                  "datasetName": "bc463c3f",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_job_name",
                "query": {
                  "datasetName": "8ee7685e",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_job_name",
                "query": {
                  "datasetName": "6e7c6490",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_job_name",
                "query": {
                  "datasetName": "a166c847",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_job_name",
                "query": {
                  "datasetName": "8cd4b39f",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_job_name",
                "query": {
                  "datasetName": "f5931b7b",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_job_name",
                "query": {
                  "datasetName": "1e4e16c0",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_job_name",
                "query": {
                  "datasetName": "da68cf08",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_job_name",
                "query": {
                  "datasetName": "9bbfcd27",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_job_name",
                "query": {
                  "datasetName": "fe4804e7",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_job_name",
                "query": {
                  "datasetName": "9f1b61ef",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_job_name",
                "query": {
                  "datasetName": "9738c1b0",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_job_name",
                "query": {
                  "datasetName": "9cc64b3d",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_job_name",
                "query": {
                  "datasetName": "747b8e0e",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e184f844664253db9be3d_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e190795f396ef64ed632c_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e196eb9f4b61cdc524557_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e19d7ab28b298bc5d5f64_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef931c354e1a28b3d63ba275c2c068_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932b112018b297e6fe373b6f4991_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932e9c0414d1adbb7feabeb7904b_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef932f2eca1b078d8eb898ccd75420_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93304b241845a0e570b54b483387_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef93322c881206b9008e9618b3bc3d_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef9547d1c11cce813b5772a486c580_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956d4a8b1ed0a48c98e4f1a60599_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef956ea190112d9ff3e08ce5e4abc7_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef957710581b28973e59b81d361ac0_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef95782cea1784ad4080357e0d062e_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960545d81a3caa9fd52d71b338fb_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960924b0102f9a9c6b3128fb2ca7_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960baaa51fe3807e9969b7f25bbc_job_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01ef931c35481d2593d1eef1ae0bd192/datasets/01ef960bc21917b79348ebed24c5e45f_job_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Job Name"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 11,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "41a12c74",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "1e4e16c0",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "job_date",
                      "expression": "`job_date`"
                    },
                    {
                      "name": "avg(job_duration_in_secs)",
                      "expression": "AVG(`job_duration_in_secs`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "job_date",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "job_date"
                },
                "y": {
                  "fieldName": "avg(job_duration_in_secs)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Average job_duration_in_secs"
                },
                "color": {
                  "fieldName": "sku_name",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "Unbilled",
                        "color": "#919191"
                      }
                    ]
                  },
                  "displayName": "sku_name"
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Job Run Time Trend",
                "description": "Average job run time (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 68,
            "width": 6,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "64642f78",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    },
                    {
                      "name": "run_as",
                      "expression": "`run_as`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of list_cost"
                },
                "color": {
                  "fieldName": "run_as",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "run_as"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Allocated Job Cost By User",
                "description": "Job run cost per user"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 34,
            "width": 2,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "88433c9b",
            "textbox_spec": "### Cost Breakdown and Usage Analysis Section\n----\nThis section provides a comprehensive view of job-related costs, broken down by various dimensions to enable deeper insights into spending patterns and resource utilization. Key elements include:\n\n1. **Daily Cost by Workspace and SKU**: Visuals displaying daily cost trends segmented by workspace and SKU, helping users identify the main contributors to job-related expenditures.\n\n2. **Cost by Team**: A breakdown of costs by team, allowing for team-specific insights and accountability in resource usage.\n\n3. **Cost Allocated by Users**: Charts showing job costs attributed to specific users, giving visibility into individual usage patterns and potential optimization areas.\n\n4. **Daily Cost per Status**: Analysis of daily costs segmented by job status, such as succeeded, error, or cancelled, providing insights into how job outcomes affect resource usage.\n\n5. **Expensive Jobs Table**: A table listing high-cost jobs, detailing list costs, number of runs, and associated sources, facilitating targeted optimizations of costly operations.\n\nThis section empowers teams with clear, actionable data to manage job costs effectively and optimize job-related resource consumption."
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "3ce0d928",
            "textbox_spec": "### Operational Analysis Section\n----\nThis section provides operational insights into job execution patterns, run durations, and reliability, supporting teams in optimizing job efficiency and troubleshooting issues. Key visualizations include:\n\n1. **Job Run Count Change Over Time by Team**: A trend view of job run counts over time, organized by team, which enables teams to assess their job activity levels and identify any operational shifts.\n\n2. **Job Run Time per Day by Job Name and SKU**: Visualizes daily run times grouped by job name and SKU, helping users identify resource-intensive jobs and optimize job configuration or scheduling.\n\n3. **Run Time by Trigger Type and Status**: A breakdown of job run times segmented by trigger type (e.g., cron, periodic) and status, providing insights into the efficiency and success rates of different job triggers.\n\n4. **Top 10 Longest Running Jobs (Last 7 Days)**: Shows the longest-running jobs over the past week, enabling teams to examine and potentially optimize time-consuming jobs.\n\n5. **Highest Failure Jobs (Last 30 Days)**: Identifies jobs with the most failures in the past month, highlighting jobs that may need troubleshooting to improve reliability.\n\nThis section offers a comprehensive view of job operations, empowering teams to monitor performance, troubleshoot high-failure jobs, and enhance operational efficiency across their workloads.\n"
          },
          "position": {
            "x": 0,
            "y": 52,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "71ccb23c",
            "textbox_spec": "### Cluster Analysis Section\n----\nThis section provides detailed insights into the resource utilization of job clusters, helping teams optimize cluster configurations for cost-efficiency and performance. Key components include:\n\n1. **Average Memory and CPU Utilization Across Jobs**: Visualizations of memory and CPU utilization across all jobs, offering an overview of resource demands and helping identify potential areas for efficiency improvements.\n\n2. **Peak and Average Memory and CPU Utilization by Job**: A table with detailed metrics on each job's peak and average resource usage, allowing teams to pinpoint resource-intensive jobs and fine-tune configurations for optimal performance.\n\n3. **Jobs with Fixed Number of Workers**: Identifies jobs running with a fixed worker count, providing insights into workload distribution and helping teams evaluate if dynamic scaling might improve efficiency.\n\n4. **Jobs Running Outdated DBR**: Lists jobs using outdated Databricks Runtime (DBR) versions, encouraging teams to update for better performance, security, and compatibility.\n\n5. **Jobs Running on All-Purpose Compute**: Displays jobs running on all-purpose clusters, helping identify opportunities to shift workloads to job-specific clusters, which can be more cost-effective.\n\nThis section supports effective resource allocation and performance tuning by highlighting areas where job cluster configurations could be optimized to reduce costs and enhance performance.\n"
          },
          "position": {
            "x": 0,
            "y": 95,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "ebe52478",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "sum(LastPeriodSpend)",
                      "expression": "SUM(`LastPeriodSpend`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(LastPeriodSpend)",
                  "displayName": "Sum of LastPeriodSpend"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Last Period $list Spend",
                "description": "Spend in the above period"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 48,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "c7bc6bad",
            "queries": [
              {
                "name": "parameter_dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92615ea9130e97b71e1cda3726a0_number_of_days",
                "query": {
                  "datasetName": "12c6b9d3",
                  "parameters": [
                    {
                      "name": "number_of_days",
                      "keyword": "number_of_days"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "number_of_days",
                    "queryName": "parameter_dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92615ea9130e97b71e1cda3726a0_number_of_days"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Number of days to compare in the next table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 46,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "786bde8d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "sum(OlderPeriodSpend)",
                      "expression": "SUM(`OlderPeriodSpend`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(OlderPeriodSpend)",
                  "displayName": "Sum of OlderPeriodSpend"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Older Period $list Spend",
                "description": "Spend in the previous period"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 50,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "15b7acad",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "run_as",
                      "expression": "`run_as`"
                    },
                    {
                      "name": "LastPeriodSpend",
                      "expression": "`LastPeriodSpend`"
                    },
                    {
                      "name": "OlderPeriodSpend",
                      "expression": "`OlderPeriodSpend`"
                    },
                    {
                      "name": "LastPeriodGrowth",
                      "expression": "`LastPeriodGrowth`"
                    },
                    {
                      "name": "LastPeriodGrowthPct",
                      "expression": "`LastPeriodGrowthPct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "run_as",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 6,
                    "title": "run_as",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_as"
                  },
                  {
                    "fieldName": "LastPeriodSpend",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 8,
                    "title": "LastPeriodSpend",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "LastPeriodSpend"
                  },
                  {
                    "fieldName": "OlderPeriodSpend",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 9,
                    "title": "OlderPeriodSpend",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "OlderPeriodSpend"
                  },
                  {
                    "fieldName": "LastPeriodGrowth",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 10,
                    "title": "LastPeriodGrowth",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "LastPeriodGrowth"
                  },
                  {
                    "fieldName": "LastPeriodGrowthPct",
                    "numberFormat": "0.00%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 11,
                    "title": "LastPeriodGrowthPct",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": null
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "LastPeriodGrowthPct",
                            "fn": ">",
                            "literal": "30"
                          },
                          "value": {
                            "foregroundColor": "#E92828"
                          }
                        }
                      ]
                    },
                    "displayName": "LastPeriodGrowthPct"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "sku_name",
                  "type": "string",
                  "displayAs": "string",
                  "order": 7,
                  "title": "sku_name",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Highest change in monthly $list",
                "description": "Tabular details of what has changed per job in the given period"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 46,
            "width": 5,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "1cb0835b",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "bc463c3f",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "usage_end_time",
                      "expression": "`usage_end_time`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "run_as",
                      "expression": "`run_as`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "workspace_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "usage_end_time",
                    "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 6,
                    "title": "usage_end_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "usage_end_time"
                  },
                  {
                    "fieldName": "runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 7,
                    "title": "runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "runs"
                  },
                  {
                    "fieldName": "run_as",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 8,
                    "title": "run_as",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_as"
                  },
                  {
                    "fieldName": "list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 9,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 1,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Most Expensive Jobs Last 30 Days",
                "showDescription": true,
                "description": "List the most expensive jobs and includes the $list for the last 30 days combined."
              }
            }
          },
          "position": {
            "x": 2,
            "y": 34,
            "width": 4,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "df39f22f",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "tags",
                      "expression": "`tags`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "tags",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 6,
                    "title": "tags",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "tags"
                  },
                  {
                    "fieldName": "list_cost",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 8,
                    "title": "list_cost_t30",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "run_as",
                  "type": "string",
                  "displayAs": "string",
                  "order": 5,
                  "title": "run_as",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "first(recent_sku_name)",
                  "type": "string",
                  "displayAs": "string",
                  "order": 7,
                  "title": "first(recent_sku_name)",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Untagged Jobs Last 30 Days",
                "description": "These jobs are not tagged and have been run in last 30 days; consider tagging them for cost attribution"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 78,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "7519e499",
            "textbox_spec": "### Cost Comparison and Change Analysis Section\n----\nThis section allows users to compare job costs over customizable timeframes, providing a focused view of spending changes and recent cost fluctuations. By entering a specific number of days (e.g., 7 days), users can view:\n\n1. **Comparative Cost Overview**: Displays the cost of the chosen period (e.g., last 7 days) alongside the prior period, enabling quick insights into recent spending trends and potential anomalies.\n\n2. **Detailed Change Analysis**: A breakdown of job-level cost changes within the selected timeframe, highlighting specific jobs with notable increases or decreases. This granularity helps users identify areas where job-related costs have shifted and provides insights for targeted optimization.\n\nThis section supports proactive cost management by making it easy to detect trends and act on changes in job-related spending, ensuring teams can maintain control over resource allocation and cost efficiency.\n"
          },
          "position": {
            "x": 0,
            "y": 41,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "55342bf7",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "8ee7685e",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "daily(usage_date)",
                      "expression": "DATE_TRUNC(\"DAY\", `usage_date`)"
                    },
                    {
                      "name": "sum(no_of_runs)",
                      "expression": "SUM(`no_of_runs`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "daily(usage_date)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "usage_date"
                },
                "y": {
                  "fieldName": "sum(no_of_runs)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of no_of_runs"
                },
                "color": {
                  "fieldName": "team_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "team_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Job run count with time",
                "description": "Number of job runs (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 57,
            "width": 4,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "7b287306",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "6e7c6490",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "run_as",
                      "expression": "`run_as`"
                    },
                    {
                      "name": "failures",
                      "expression": "`failures`"
                    },
                    {
                      "name": "success_ratio",
                      "expression": "`success_ratio`"
                    },
                    {
                      "name": "failure_list_cost",
                      "expression": "`failure_list_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 6,
                    "title": "runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "runs"
                  },
                  {
                    "fieldName": "run_as",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 7,
                    "title": "run_as",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_as"
                  },
                  {
                    "fieldName": "failures",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 8,
                    "title": "failures",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "failures"
                  },
                  {
                    "fieldName": "success_ratio",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 9,
                    "title": "success_ratio",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": null
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "success_ratio",
                            "fn": "<",
                            "literal": "90"
                          },
                          "value": {
                            "foregroundColor": "#E92828"
                          }
                        }
                      ]
                    },
                    "displayName": "success_ratio"
                  },
                  {
                    "fieldName": "failure_list_cost",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 10,
                    "title": "failure_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "failure_list_cost"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "dateTimeFormat": "YYYY-MM-DD",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "last_seen_date",
                  "type": "datetime",
                  "displayAs": "datetime",
                  "order": 11,
                  "title": "last_seen_date",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Highest Failure Jobs Last 30 Days",
                "description": "Shows jobs with a high number of failed runs over the last 30 days; includes number of runs, number of failures, the success ratio, and list cost of the job\u2019s failed runs."
              }
            }
          },
          "position": {
            "x": 3,
            "y": 78,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "784c0606",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a166c847",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "run_id",
                      "expression": "`run_id`"
                    },
                    {
                      "name": "last_seen_date",
                      "expression": "`last_seen_date`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "run_as",
                      "expression": "`run_as`"
                    },
                    {
                      "name": "repairs",
                      "expression": "`repairs`"
                    },
                    {
                      "name": "repair_time_seconds",
                      "expression": "`repair_time_seconds`"
                    },
                    {
                      "name": "repair_list_cost",
                      "expression": "`repair_list_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "run_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "run_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_id"
                  },
                  {
                    "fieldName": "last_seen_date",
                    "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 5,
                    "title": "last_seen_date",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "last_seen_date"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 6,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 7,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "run_as",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 8,
                    "title": "run_as",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_as"
                  },
                  {
                    "fieldName": "repairs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 9,
                    "title": "repairs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "repairs"
                  },
                  {
                    "fieldName": "repair_time_seconds",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 10,
                    "title": "repair_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "description": "Repair time in seconds",
                    "displayName": "repair_time_seconds"
                  },
                  {
                    "fieldName": "repair_list_cost",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 11,
                    "title": "repair_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "repair_list_cost"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 1,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Most Retried Runs Last 30 Days",
                "showDescription": true,
                "description": "Lists jobs with frequent repairs over the last 30 days, including the number of repairs, the cumulative duration of the repair runs, and the cost of the repairs. NULL repair time means there was no successful repair (yet)."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 84,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "d3b8fa59",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "8cd4b39f",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "total_list_cost",
                      "expression": "`total_list_cost`"
                    },
                    {
                      "name": "avg_list_cost",
                      "expression": "`avg_list_cost`"
                    },
                    {
                      "name": "max_list_cost",
                      "expression": "`max_list_cost`"
                    },
                    {
                      "name": "p90",
                      "expression": "`p90`"
                    },
                    {
                      "name": "last_seen_date",
                      "expression": "`last_seen_date`"
                    },
                    {
                      "name": "list_cost_deviation_from_p90",
                      "expression": "`list_cost_deviation_from_p90`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 6,
                    "title": "runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "runs"
                  },
                  {
                    "fieldName": "total_list_cost",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 7,
                    "title": "total_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "total_list_cost"
                  },
                  {
                    "fieldName": "avg_list_cost",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 8,
                    "title": "avg_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "avg_list_cost"
                  },
                  {
                    "fieldName": "max_list_cost",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 9,
                    "title": "max_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "max_list_cost"
                  },
                  {
                    "fieldName": "p90",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 10,
                    "title": "p90_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "p90"
                  },
                  {
                    "fieldName": "last_seen_date",
                    "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 11,
                    "title": "last_seen_date",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "last_seen_date"
                  },
                  {
                    "fieldName": "list_cost_deviation_from_p90",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 12,
                    "title": "list_cost_deviation_from_p90",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost_deviation_from_p90"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Jobs Outliers Last 30 Days",
                "showDescription": true,
                "description": "Helps analyze the job's $list deviation across multiple runs. "
              }
            }
          },
          "position": {
            "x": 0,
            "y": 90,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "3fd94b5d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "f5931b7b",
                  "fields": [
                    {
                      "name": "countdistinct(run_id)",
                      "expression": "COUNT(DISTINCT `run_id`)"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "countdistinct(run_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of query runs"
                },
                "color": {
                  "fieldName": "workspace_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "workspace_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Run count t30",
                "description": "Job run count comparison in workspaces"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 57,
            "width": 1,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "8647a21e",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "f5931b7b",
                  "fields": [
                    {
                      "name": "countdistinct(job_id)",
                      "expression": "COUNT(DISTINCT `job_id`)"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "countdistinct(job_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of Unique job_id"
                },
                "color": {
                  "fieldName": "workspace_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "workspace_name"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Job count t30",
                "showDescription": true,
                "description": "Job count comparison in workspaces"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 57,
            "width": 1,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "48b14cb6",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "da68cf08",
                  "fields": [
                    {
                      "name": "result_state",
                      "expression": "`result_state`"
                    },
                    {
                      "name": "daily(period_end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `period_end_time`)"
                    },
                    {
                      "name": "countdistinct(run_id)",
                      "expression": "COUNT(DISTINCT `run_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(period_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "period_end_time"
                },
                "y": {
                  "fieldName": "countdistinct(run_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "% of jobs by run status"
                  },
                  "displayName": "% of jobs by run status"
                },
                "color": {
                  "fieldName": "result_state",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "CANCELLED",
                        "color": "#077A9D"
                      },
                      {
                        "value": "ERROR",
                        "color": "#FF3621"
                      },
                      {
                        "value": "FAILED",
                        "color": "#FCA4A1"
                      },
                      {
                        "value": "SUCCEEDED",
                        "color": "#00A972"
                      }
                    ]
                  },
                  "displayName": "result_state"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Daily Run Status Distribution",
                "description": "Breakup of job status as percentage (y-axis) over time (x-axis)"
              },
              "mark": {
                "layout": "percent-stack"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 62,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "f8cec56c",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "da68cf08",
                  "fields": [
                    {
                      "name": "avg(job_duration_in_secs)",
                      "expression": "AVG(`job_duration_in_secs`)"
                    },
                    {
                      "name": "result_state",
                      "expression": "`result_state`"
                    },
                    {
                      "name": "trigger_type",
                      "expression": "`trigger_type`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "result_state",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "result_state"
                },
                "y": {
                  "fieldName": "trigger_type",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "trigger_type"
                },
                "color": {
                  "fieldName": "avg(job_duration_in_secs)",
                  "scale": {
                    "type": "quantitative",
                    "colorRamp": {
                      "mode": "scheme",
                      "scheme": "greenblue"
                    }
                  },
                  "displayName": "Avg TIme sec"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Job Runtime By Trigger Type and Status",
                "description": "Job runtime distribution with trigger type (y-axis) and status (x-axis)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 72,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "de40ea53",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "1e4e16c0",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "daily(job_date)",
                      "expression": "DATE_TRUNC(\"DAY\", `job_date`)"
                    },
                    {
                      "name": "sum(job_duration_in_secs)",
                      "expression": "SUM(`job_duration_in_secs`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(job_date)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "job_date"
                },
                "y": {
                  "fieldName": "sum(job_duration_in_secs)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of job_duration_in_secs"
                },
                "color": {
                  "fieldName": "job_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "job_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Job Runtime per Day",
                "description": "Breakup of runtime in seconds (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 62,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "3f80df0e",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9bbfcd27",
                  "fields": [
                    {
                      "name": "result_state",
                      "expression": "`result_state`"
                    },
                    {
                      "name": "daily(usage_end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `usage_end_time`)"
                    },
                    {
                      "name": "sum(result_state_cost)",
                      "expression": "SUM(`result_state_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(usage_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "usage_end_time"
                },
                "y": {
                  "fieldName": "sum(result_state_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "% of $list by run status"
                  },
                  "displayName": "% of $list by run status"
                },
                "color": {
                  "fieldName": "result_state",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "ERROR",
                        "color": "#FF3621"
                      },
                      {
                        "value": "FAILED",
                        "color": "#FCA4A1"
                      },
                      {
                        "value": "SKIPPED",
                        "color": "#8BCAE7"
                      },
                      {
                        "value": "SUCCEEDED",
                        "color": "#00A972"
                      },
                      {
                        "value": "TIMED_OUT",
                        "color": "#919191"
                      }
                    ]
                  },
                  "displayName": "result_state"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Daily $list by Run Status Distribution",
                "description": "Breakup of spend per job status (y-axis) over time (x-axis)"
              },
              "mark": {
                "layout": "percent-stack"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 29,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "a7a93c32",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "fe4804e7",
                  "fields": [
                    {
                      "name": "sum(avg_seconds)",
                      "expression": "SUM(`avg_seconds`)"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(avg_seconds)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of avg_seconds"
                },
                "color": {
                  "fieldName": "job_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "job_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Top 10 longest running jobs t30",
                "description": "Longest running jobs in the last 30 days"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 72,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "1c4e5c8d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9f1b61ef",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "Avg CPU Utilization",
                      "expression": "`Avg CPU Utilization`"
                    },
                    {
                      "name": "Peak CPU Utilization",
                      "expression": "`Peak CPU Utilization`"
                    },
                    {
                      "name": "Avg Memory Utilization",
                      "expression": "`Avg Memory Utilization`"
                    },
                    {
                      "name": "Max Memory Utilization",
                      "expression": "`Max Memory Utilization`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "Avg CPU Utilization",
                    "numberFormat": "0.00%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 6,
                    "title": "Avg CPU Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": null
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "Avg CPU Utilization",
                            "fn": "<",
                            "literal": "25"
                          },
                          "value": {
                            "foregroundColor": "#E92828"
                          }
                        }
                      ]
                    },
                    "displayName": "Avg CPU Utilization"
                  },
                  {
                    "fieldName": "Peak CPU Utilization",
                    "numberFormat": "0.00%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 8,
                    "title": "Peak CPU Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Peak CPU Utilization"
                  },
                  {
                    "fieldName": "Avg Memory Utilization",
                    "numberFormat": "0.00%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 11,
                    "title": "Avg Memory Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": null
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "Avg Memory Utilization",
                            "fn": ">",
                            "literal": "90"
                          },
                          "value": {
                            "foregroundColor": "#E92828"
                          }
                        }
                      ]
                    },
                    "displayName": "Avg Memory Utilization"
                  },
                  {
                    "fieldName": "Max Memory Utilization",
                    "numberFormat": "0.00%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 12,
                    "title": "Max Memory Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": null
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "Max Memory Utilization",
                            "fn": ">",
                            "literal": "99"
                          },
                          "value": {
                            "foregroundColor": "#E92828"
                          }
                        }
                      ]
                    },
                    "displayName": "Max Memory Utilization"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00%",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Avg Unutilized CPU",
                  "type": "float",
                  "displayAs": "number",
                  "order": 7,
                  "title": "Avg Unutilized CPU",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false,
                  "cellFormat": {
                    "default": {
                      "foregroundColor": null
                    },
                    "rules": [
                      {
                        "if": {
                          "column": "Avg Unutilized CPU",
                          "fn": ">",
                          "literal": "75"
                        },
                        "value": {
                          "foregroundColor": "#E92828"
                        }
                      }
                    ]
                  }
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Avg CPU Disk Wait",
                  "type": "float",
                  "displayAs": "number",
                  "order": 9,
                  "title": "Avg CPU Disk Wait",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Max CPU Disk Wait",
                  "type": "float",
                  "displayAs": "number",
                  "order": 10,
                  "title": "Max CPU Disk Wait",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "CPU and Memory Utilization per Job",
                "showDescription": true,
                "description": "Tablular level details of the above chart showing  CPU and Memory for jobs. This, by default, is sorted on the lowest average memory, but can be sorted by other columns by clicking on the corresponding column name."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 105,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "bc548d23",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9f1b61ef",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "avg(Avg Memory Utilization)",
                      "expression": "AVG(`Avg Memory Utilization`)"
                    },
                    {
                      "name": "avg(Avg CPU Utilization)",
                      "expression": "AVG(`Avg CPU Utilization`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "job_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "axis": {
                    "hideLabels": true
                  },
                  "displayName": "job_name"
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "avg(Avg Memory Utilization)",
                      "displayName": "Avg Memory Utilization"
                    },
                    {
                      "fieldName": "avg(Avg CPU Utilization)",
                      "displayName": "Avg CPU Utilization"
                    }
                  ]
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Average CPU and Memory Utilization across jobs",
                "description": "Average Utilization of Memory and CPU (y-axis) across different jobs (x-axis). X-axis is job_name (not time) and hovering over it will show the name of the job.\n- Jobs with low CPU and memory are not close to fully leveraging the hardware potential; consider reducing hardware.\n- Jobs with very high memory utilization could experience bottlenecks; consider increasing memory allocation. "
              }
            }
          },
          "position": {
            "x": 0,
            "y": 100,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "55584cb1",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9738c1b0",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "run_as",
                      "expression": "`run_as`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    },
                    {
                      "name": "worker_count",
                      "expression": "`worker_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "run_as",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "run_as",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_as"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "list_cost",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 6,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  },
                  {
                    "fieldName": "worker_count",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 8,
                    "title": "worker_count",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "worker_count"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "job_type_from_sku",
                  "type": "string",
                  "displayAs": "string",
                  "order": 7,
                  "title": "job_type_from_sku",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "min_autoscale_workers",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 9,
                  "title": "min_autoscale_workers",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "max_autoscale_workers",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 10,
                  "title": "max_autoscale_workers",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Jobs with Fixed Number of Workers Last 30 Days",
                "description": "These jobs do not leverage autoscaling, consider adding it to optimise the resources utilisation."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 110,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "9a0cd5c5",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9cc64b3d",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "run_as",
                      "expression": "`run_as`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "sum(list_cost)",
                      "expression": "`sum(list_cost)`"
                    },
                    {
                      "name": "any_value(dbr_Version)",
                      "expression": "`any_value(dbr_Version)`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "run_as",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "run_as",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_as"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100006,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "sum(list_cost)",
                    "numberFormat": "$0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "sum(list_cost)"
                  },
                  {
                    "fieldName": "any_value(dbr_Version)",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100008,
                    "title": "dbr_Version",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "any_value(dbr_Version)"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100000,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Jobs Running on Outdated DBR Version Last 30 Days",
                "description": "These jobs are on old runtimes; consider upgrading to ensure optimal performance and ability to use new features"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 110,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "d7b3fce8",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "747b8e0e",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "task_runs",
                      "expression": "`task_runs`"
                    },
                    {
                      "name": "clusters_list",
                      "expression": "`clusters_list`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "task_runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "task_runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "task_runs"
                  },
                  {
                    "fieldName": "clusters_list",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 100007,
                    "title": "clusters_list",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "clusters_list"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100000,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "job_type_from_sku",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100005,
                  "title": "job_type_from_sku",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Most Frequent Jobs on All Purpose Clusters Last 30 Days",
                "description": "High frequency jobs executed on all purpose clusters might prevent them from shutting down."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 116,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "21e10894",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "38f9cb3c",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "unused_datasets",
                      "expression": "`unused_datasets`"
                    },
                    {
                      "name": "used_datasets",
                      "expression": "`used_datasets`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "job_type_from_sku",
                      "expression": "`job_type_from_sku`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    },
                    {
                      "name": "no_of_unused_datasets",
                      "expression": "`no_of_unused_datasets`"
                    },
                    {
                      "name": "created_by",
                      "expression": "`created_by`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "job_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "job_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "unused_datasets",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 4,
                    "title": "unused_datasets",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "unused_datasets"
                  },
                  {
                    "fieldName": "used_datasets",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 5,
                    "title": "used_datasets",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "used_datasets"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 6,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "job_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 7,
                    "title": "job_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_type_from_sku"
                  },
                  {
                    "fieldName": "list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 8,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  },
                  {
                    "fieldName": "no_of_unused_datasets",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 9,
                    "title": "no_of_unused_datasets",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "no_of_unused_datasets"
                  },
                  {
                    "fieldName": "created_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 10,
                    "title": "created_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "created_by"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Stale Datasets Produced Last 30 Days",
                "description": "Shows unused datasets created by jobs which are not getting consumed anywhere"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 84,
            "width": 3,
            "height": 6
          }
        }
      ]
    }
  ]
}