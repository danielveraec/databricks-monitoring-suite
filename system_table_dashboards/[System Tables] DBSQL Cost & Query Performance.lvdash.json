{
  "datasets": [
    {
      "name": "bb7e5c78",
      "displayName": "wow_growth",
      "query": "with queries_usage_with_list_cost as (\n  SELECT\n    t1.*,\n    t1.usage_quantity * list_prices.pricing.default as list_cost\n  FROM\n    system.billing.usage t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'SQL'\n    and t1.usage_metadata.warehouse_id IS NOT NULL\n),\nweekly_queries_list_cost as (\n  select\n    date_sub(\n      to_date(usage_start_time),\n      dayofweek(to_date(usage_start_time))\n    ) as week_start,\n    SUM(list_cost) as list_cost,\n    COUNT(distinct to_date(usage_start_time)) as days\n  from\n    queries_usage_with_list_cost t1\n  group by\n    all\n  having\n    days = 7\n  order by\n    1 asc,\n    2 asc\n),\nlist_cost_growth as (\n  select\n    week_start,\n    list_cost,\n    100 * (\n      list_cost - lag(list_cost, 1) over (\n        order by\n          week_start\n      )\n    ) / lag(list_cost, 1) over (\n      order by\n        week_start\n    ) as weekly_growth\n  from\n    weekly_queries_list_cost\n  order by\n    week_start asc\n)\nselect\n  week_start,\n  weekly_growth,\n  avg(weekly_growth) over (\n    order by\n      week_start ROWS BETWEEN 12 preceding\n      AND CURRENT ROW\n  ) as 3_months_growth_moving_avg,\n  list_cost\nfrom\n  list_cost_growth;"
    },
    {
      "name": "07398605",
      "displayName": "query_run_cost",
      "query": "with billing_w_org_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, null) as team_name\n  FROM\n    system.billing.usage t1\n)\nSELECT\n  t1.*\nexcept(team_name),\n  t2.workspace_name,\n  t1.usage_metadata.warehouse_id as warehouse_id,\n  coalesce(\n    t3.warehouse_name,\n    t1.usage_metadata.warehouse_id\n  ) as warehouse_name,\n  ifnull(\n    {catalog}.{schema}.sql_type_from_sku(t1.sku_name),\n    'UNKNOWN'\n  ) as sql_type_from_sku,\n  ifnull(t1.team_name, 'unknown') as team_name,\n  t1.identity_metadata.run_as as run_as,\n  t1.usage_quantity * list_prices.pricing.default AS list_cost\nFROM\n  billing_w_org_team t1\n  INNER JOIN system.billing.list_prices list_prices ON t1.cloud = list_prices.cloud\n  AND t1.sku_name = list_prices.sku_name\n  AND t1.usage_start_time >= list_prices.price_start_time\n  AND (\n    t1.usage_end_time <= list_prices.price_end_time\n    or list_prices.price_end_time is NULL\n  )\n  LEFT JOIN {catalog}.{schema}.workspace_reference t2 USING (workspace_id)\n  LEFT JOIN {catalog}.{schema}.warehouse_reference t3 ON t1.workspace_id = t3.workspace_id\n  AND t1.usage_metadata.warehouse_id = t3.warehouse_id\nWHERE\n  t1.billing_origin_product = 'SQL'\n  AND t1.usage_metadata.warehouse_id IS NOT NULL;"
    },
    {
      "name": "0655a5b3",
      "displayName": "30_60_days_spend",
      "query": "with billing_w_org_team as (\n  SELECT\n    t1.*,\n    t1.usage_metadata.warehouse_id as warehouse_id,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, null) as team_name\n  FROM\n    system.billing.usage t1\n),\nqueries_usage_with_list_cost as (\n  SELECT\n    t1.*,\n    t1.usage_quantity * list_prices.pricing.default as list_cost\n  FROM\n    billing_w_org_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'SQL'\n    and t1.usage_metadata.warehouse_id IS NOT NULL\n)\nSELECT\n  t1.*,\n  t3.workspace_name,\n  coalesce(t4.warehouse_name, t1.warehouse_id) as warehouse_name,\n  try_divide(\n    (last30DaySpend - last30to60DaySpend),\n    last30to60DaySpend\n  ) * 100 AS Last30DayGrowth\nFROM\n  (\n    SELECT\n      SUM(list_cost) AS spend,\n      workspace_id,\n      warehouse_id,\n      sku_name,\n      ifnull(\n        {catalog}.{schema}.sql_type_from_sku(sku_name),\n        'UNKNOWN'\n      ) as sql_type_from_sku,\n      ifnull(team_name, 'unknown') as team_name,\n      SUM(\n        CASE\n          WHEN usage_end_time BETWEEN date_add(current_date(), -30)\n          AND (current_date() - 1) THEN list_cost\n          ELSE 0\n        END\n      ) AS Last30DaySpend,\n      SUM(\n        CASE\n          WHEN usage_end_time BETWEEN date_add(current_date(), -60)\n          AND date_add(current_date(), -31) THEN list_cost\n          ELSE 0\n        END\n      ) AS Last30to60DaySpend\n    FROM\n      queries_usage_with_list_cost\n    GROUP BY\n      ALL\n  ) t1\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN {catalog}.{schema}.warehouse_reference t4 USING (workspace_id, warehouse_id);"
    },
    {
      "name": "11611f07",
      "displayName": "spend_by_tag",
      "query": "with billing_w_org_team as (\n  SELECT\n    t1.*,\n    {catalog}.{schema}.team_name_from_tags(t1.custom_tags, null) as team_name\n  FROM\n    system.billing.usage t1\n),\ntagraw as (\n  select\n    workspace_id,\n    usage_metadata.warehouse_id as warehouse_id,\n    ifnull(\n      {catalog}.{schema}.sql_type_from_sku(t1.sku_name),\n      'UNKNOWN'\n    ) as sql_type_from_sku,\n    ifnull(t1.team_name, 'unknown') as team_name,\n    (usage_quantity * list_prices.pricing.default) as list_cost\n  from\n    billing_w_org_team t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'SQL'\n    and t1.usage_metadata.warehouse_id IS NOT NULL\n    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY\n),\ntagspend as (\n  select\n    workspace_id,\n    warehouse_id,\n    sql_type_from_sku,\n    team_name as tagbucket,\n    sum(list_cost) as list_cost\n  from\n    tagraw\n  group by\n    ALL\n)\nselect\n  t1.*,\n  t3.workspace_name,\n  coalesce(t4.warehouse_name, t1.warehouse_id) as warehouse_name\nfrom\n  tagspend t1\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN {catalog}.{schema}.warehouse_reference t4 USING (workspace_id, warehouse_id);"
    },
    {
      "name": "566012fa",
      "displayName": "query_history_w_cost",
      "query": "WITH raw_history AS (\n  SELECT\n    workspace_id,\n    statement_id,\n    executed_by,\n    statement_text,\n    compute.warehouse_id AS warehouse_id,\n    execution_status,\n    ifnull(statement_type, 'Other') as statement_type,\n    COALESCE(client_application, 'Unknown') AS client_application,\n    COALESCE(try_divide(total_duration_ms, 1000), 0) AS QueryRuntimeSeconds,\n    COALESCE(try_divide(total_task_duration_ms, 1000), 0) AS CPUTotalExecutionTime,\n    COALESCE(try_divide(execution_duration_ms, 1000), 0) AS ExecutionQueryTime,\n    COALESCE(try_divide(compilation_duration_ms, 1000), 0) AS CompilationQueryTime,\n    COALESCE(\n      try_divide(waiting_at_capacity_duration_ms, 1000),\n      0\n    ) AS QueueQueryTime,\n    COALESCE(\n      try_divide(waiting_for_compute_duration_ms, 1000),\n      0\n    ) AS StartUpQueryTime,\n    COALESCE(try_divide(result_fetch_duration_ms, 1000), 0) AS ResultFetchTime,\n    CASE\n      WHEN COALESCE(try_divide(total_task_duration_ms, 1000), 0) = 0 THEN 0\n      ELSE COALESCE(try_divide(total_duration_ms, 1000), 0) + COALESCE(try_divide(compilation_duration_ms, 1000), 0) -- Query total time is compile time + execution time\n    END AS TotalResourceTimeUsedForAllocation,\n    start_time,\n    end_time,\n    update_time,\n    COALESCE(read_bytes, 0) AS read_bytes,\n    COALESCE(read_io_cache_percent, 0) AS read_io_cache_percent,\n    from_result_cache,\n    COALESCE(spilled_local_bytes, 0) AS spilled_local_bytes,\n    COALESCE(total_task_duration_ms / total_duration_ms, NULL) AS TotalCPUTime_To_Execution_Time_Ratio,\n    COALESCE(\n      waiting_at_capacity_duration_ms / total_duration_ms,\n      0\n    ) AS ProportionQueueTime,\n    AVG(try_divide(total_duration_ms, 1000)) OVER () AS WarehouseAvgQueryRuntime,\n    AVG(\n      try_divide(waiting_at_capacity_duration_ms, 1000)\n    ) OVER () AS WarehouseAvgQueueTime,\n    AVG(\n      COALESCE(\n        try_divide(waiting_at_capacity_duration_ms, 1000) / try_divide(total_duration_ms, 1000),\n        0\n      )\n    ) OVER () AS WarehouseAvgProportionTimeQueueing,\n    CASE\n      WHEN read_bytes > 0 THEN try_divide(read_bytes,(1024 * 1024 * 1024))\n      ELSE 0\n    END AS ReadDataAmountInGB,\n    CASE\n      WHEN read_io_cache_percent > 0 THEN 'Used Cache'\n      ELSE 'No Cache'\n    END AS UsedCacheFlag,\n    CASE\n      WHEN spilled_local_bytes > 0 THEN 'Spilled Data To Disk'\n      ELSE 'No Spill'\n    END AS HasSpillFlag,\n    CASE\n      WHEN read_bytes > 0 THEN 'Did Read Data'\n      ELSE 'No Data Read'\n    END AS ReadDataFlag,\n    CASE\n      WHEN CPUTotalExecutionTime > 0 THEN 'UsedWorkerTasks'\n      ELSE 'NoWorkers'\n    END AS UsedWorkerTasksFlag,\n    CASE\n      WHEN spilled_local_bytes > 0 THEN 1\n      ELSE 0\n    END AS Calc_HasSpillFlag,\n    CASE\n      WHEN read_bytes > 0 THEN 0.25\n      ELSE 0\n    END AS Calc_ReadDataFlag,\n    CASE\n      WHEN CPUTotalExecutionTime > 0 THEN 0.25\n      ELSE 0\n    END AS Calc_UsedWorkerTasksFlag\n  FROM\n    system.query.history f\n  WHERE\n    date(start_time) < CURRENT_DATE()\n),\nhistory AS (\n  SELECT\n    *,\n    SUM(TotalResourceTimeUsedForAllocation) OVER () AS TotalUsedTimeInWarehouse,\n    SUM(COALESCE(TotalResourceTimeUsedForAllocation, 0)) OVER (PARTITION BY statement_text) AS TotalStatementTextTimeUsed,\n    try_divide(\n      TotalResourceTimeUsedForAllocation,\n      TotalUsedTimeInWarehouse\n    ) AS ProportionOfWarehouseTimeUsedByQuery\n  FROM\n    raw_history\n),\nfiltered_warehouse_usage AS (\n  SELECT\n    t1.workspace_id,\n    t1.usage_metadata.warehouse_id,\n    SUM(t1.usage_quantity) as Total_Warehouse_Period_DBUs,\n    SUM(t1.usage_quantity * list_prices.pricing.default) as Total_Warehouse_Period_Dollars\n  FROM\n    system.billing.usage t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'SQL'\n    AND t1.usage_metadata.warehouse_id IS NOT NULL\n  GROUP BY\n    ALL\n),\ncustom_tag AS (\n  with tag_data as (\n    SELECT\n      workspace_id,\n      usage_metadata.warehouse_id as warehouse_id,\n      {catalog}.{schema}.team_name_from_tags(custom_tags, null) as team_name\n    from\n      system.billing.usage\n    WHERE\n      billing_origin_product = 'SQL'\n      AND usage_metadata.warehouse_id IS NOT NULL\n  )\n  select\n    workspace_id,\n    warehouse_id,\n    max(team_name) as team_name\n  from\n    tag_data\n  GROUP BY\n    workspace_id,\n    warehouse_id\n),\nsku_from_billing AS (\n  SELECT\n    u.workspace_id,\n    u.usage_metadata.warehouse_id as warehouse_id,\n    u.sku_name,\n    max(t1.team_name) as team_name,\n    min(u.usage_start_time) as usage_start_time,\n    max(u.usage_end_time) as usage_end_time\n  from\n    system.billing.usage u\n    LEFT JOIN custom_tag AS t1 ON u.workspace_id = t1.workspace_id\n    and u.usage_metadata.warehouse_id = t1.warehouse_id\n  WHERE\n    u.billing_origin_product = 'SQL'\n    AND u.usage_metadata.warehouse_id IS NOT NULL\n  GROUP BY\n    u.workspace_id,\n    u.usage_metadata.warehouse_id,\n    sku_name\n),\nwarehouse_average_ratio_metrics AS (\n  SELECT\n    workspace_id,\n    warehouse_id,\n    try_divide(\n      AVG(CPUTotalExecutionTime) :: float,\n      AVG(QueryRuntimeSeconds) :: float\n    ) :: float AS WarehouseAvgTaskSkewRatio,\n    try_divide(\n      MAX(CPUTotalExecutionTime),\n      MAX(QueryRuntimeSeconds)\n    ) :: float AS WarehouseMaxTaskSkewRatio,\n    AVG(ReadDataAmountInGB) :: float AS WarehouseAvgReadDataInGBPerQuery,\n    stddev(ReadDataAmountInGB) :: float AS WarehouseStdReadDataInGBPerQuery,\n    AVG(read_io_cache_percent) :: float AS WarehouseAvgDeltaCachePercent,\n    stddev(read_io_cache_percent) :: float AS WarehouseStdDeltaCachePercent,\n    AVG(spilled_local_bytes) :: float AS WarehouseAvgDiskSpillAmount,\n    stddev(spilled_local_bytes) :: float AS WarehouseStdDiskSpillAmount\n  FROM\n    history\n  WHERE\n    CPUTotalExecutionTime > 0\n    AND ReadDataAmountInGB > 0\n    AND execution_status NOT IN (\"FAILED\")\n  GROUP BY\n    workspace_id,\n    warehouse_id\n),\nquery_level_intel_metrics AS (\n  SELECT\n    qh.*,\n    s.sku_name,\n    s.team_name,\n    t2.workspace_name,\n    coalesce(t1.warehouse_name, qh.warehouse_id) as warehouse_name,\n    w.WarehouseAvgTaskSkewRatio AS WarehouseAvgTaskToExecutionTimeRatio,\n    CASE\n      WHEN CPUTotalExecutionTime > 0\n      AND ReadDataAmountInGB > 0\n      AND execution_status NOT IN (\"FAILED\") THEN try_divide(\n        QueryRuntimeSeconds,\n        try_divide(\n          qh.CPUTotalExecutionTime,\n          w.WarehouseAvgTaskSkewRatio\n        )\n      )\n      ELSE NULL\n    END AS QueryEfficiencyRatio,\n    w.WarehouseAvgReadDataInGBPerQuery,\n    w.WarehouseStdReadDataInGBPerQuery,\n    w.WarehouseAvgDeltaCachePercent,\n    w.WarehouseStdDeltaCachePercent,\n    w.WarehouseAvgDiskSpillAmount,\n    w.WarehouseStdDiskSpillAmount,\n    u.Total_Warehouse_Period_Dollars,\n    (\n      u.Total_Warehouse_Period_Dollars :: float * ProportionOfWarehouseTimeUsedByQuery :: float\n    ) AS AllocatedQueryCostByTime\n  FROM\n    history AS qh\n    LEFT JOIN warehouse_average_ratio_metrics AS w USING (workspace_id, warehouse_id)\n    LEFT JOIN filtered_warehouse_usage AS u USING (workspace_id, warehouse_id)\n    LEFT JOIN sku_from_billing AS s ON qh.warehouse_id = s.warehouse_id\n    AND qh.workspace_id = s.workspace_id\n    AND qh.start_time < s.usage_end_time\n    AND qh.end_time > s.usage_start_time\n    LEFT JOIN {catalog}.{schema}.warehouse_reference t1 USING (workspace_id, warehouse_id)\n    LEFT JOIN {catalog}.{schema}.workspace_reference t2 USING (workspace_id)\n),\nquery_with_percentiles AS (\n  SELECT\n    *,\n    ifnull(\n      {catalog}.{schema}.sql_type_from_sku(sku_name),\n      'UNKNOWN'\n    ) as sql_type_from_sku,\n    AVG(QueryEfficiencyRatio) OVER () AS WarehouseAvgQueryEfficiencyRatio,\n    PERCENTILE_CONT(0.5) WITHIN GROUP (\n      ORDER BY\n        QueryRuntimeSeconds\n    ) OVER () AS QueryRuntime_P50,\n    PERCENTILE_CONT(0.9) WITHIN GROUP (\n      ORDER BY\n        QueryRuntimeSeconds\n    ) OVER () AS QueryRuntime_P90,\n    PERCENTILE_CONT(0.95) WITHIN GROUP (\n      ORDER BY\n        QueryRuntimeSeconds\n    ) OVER () AS QueryRuntime_P95,\n    PERCENTILE_CONT(0.99) WITHIN GROUP (\n      ORDER BY\n        QueryRuntimeSeconds\n    ) OVER () AS QueryRuntime_P99,\n    PERCENTILE_CONT(0.5) WITHIN GROUP (\n      ORDER BY\n        QueueQueryTime\n    ) OVER () AS QueryQueueTime_P50,\n    PERCENTILE_CONT(0.9) WITHIN GROUP (\n      ORDER BY\n        QueueQueryTime\n    ) OVER () AS QueryQueueTime_P90,\n    PERCENTILE_CONT(0.95) WITHIN GROUP (\n      ORDER BY\n        QueueQueryTime\n    ) OVER () AS QueryQueueTime_P95,\n    PERCENTILE_CONT(0.99) WITHIN GROUP (\n      ORDER BY\n        QueueQueryTime\n    ) OVER () AS QueryQueueTime_P99\n  FROM\n    query_level_intel_metrics\n)\nSELECT\n  *\nFROM\n  query_with_percentiles\norder by\n  AllocatedQueryCostByTime DESC;"
    },
    {
      "name": "12c6b9d3",
      "displayName": "highest_change_warehouses_in_period",
      "query": "with billing_queries_w_org_team as (\n  SELECT\n    workspace_id,\n    warehouse_id,\n    max(sku_name) as sku_name,\n    ifnull(max(team_name), 'unknown') as team_name\n  FROM\n    (\n      SELECT\n        t1.workspace_id,\n        t1.usage_metadata.warehouse_id as warehouse_id,\n        t1.sku_name,\n        {catalog}.{schema}.team_name_from_tags(t1.custom_tags, null) as team_name\n      FROM\n        system.billing.usage t1\n    )\n  group by\n    all\n),\nquery_run_timeline_with_cost as (\n  SELECT\n    t1.*,\n    t1.usage_metadata.warehouse_id as warehouse_id,\n    t1.identity_metadata.run_as as run_as,\n    t1.usage_quantity * list_prices.pricing.default AS list_cost\n  FROM\n    system.billing.usage t1\n    INNER JOIN system.billing.list_prices list_prices ON t1.cloud = list_prices.cloud\n    AND t1.sku_name = list_prices.sku_name\n    AND t1.usage_start_time >= list_prices.price_start_time\n    AND (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is NULL\n    )\n  WHERE\n    t1.billing_origin_product = 'SQL'\n    AND t1.usage_metadata.warehouse_id IS NOT NULL\n    AND t1.usage_date >= DATE_ADD(CURRENT_DATE(), -(:number_of_days * 2))\n)\nSELECT\n  coalesce(\n    t5.warehouse_name,\n    t1.warehouse_id\n  ) as warehouse_name,\n  t1.workspace_id,\n  t4.workspace_name,\n  t1.warehouse_id,\n  ifnull(t3.team_name, 'unknown') as team_name,\n  t1.sku_name,\n  ifnull(\n    {catalog}.{schema}.sql_type_from_sku(t1.sku_name),\n    'UNKNOWN'\n  ) as sql_type_from_sku,\n  t1.run_as,\n  Last7DaySpend as LastPeriodSpend,\n  Last14DaySpend as OlderPeriodSpend,\n  last7DaySpend - last14DaySpend as LastPeriodGrowth,\n  ifnull(\n    try_divide(\n      (last7DaySpend - last14DaySpend),\n      last14DaySpend\n    ) * 100,\n    100\n  ) AS LastPeriodGrowthPct\nFROM\n  (\n    SELECT\n      workspace_id,\n      warehouse_id,\n      run_as,\n      sku_name,\n      SUM(list_cost) AS spend,\n      SUM(\n        CASE\n          WHEN usage_end_time BETWEEN date_add(current_date(), -(:number_of_days))\n          AND date_add(current_date(), -1) THEN list_cost\n          ELSE 0\n        END\n      ) AS Last7DaySpend,\n      SUM(\n        CASE\n          WHEN usage_end_time BETWEEN date_add(current_date(), -(:number_of_days * 2))\n          AND date_add(current_date(), -(:number_of_days + 1)) THEN list_cost\n          ELSE 0\n        END\n      ) AS Last14DaySpend\n    FROM\n      query_run_timeline_with_cost\n    GROUP BY\n      ALL\n  ) t1\n  LEFT JOIN billing_queries_w_org_team t3 USING (workspace_id, warehouse_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t4 USING (workspace_id)\n  LEFT JOIN {catalog}.{schema}.warehouse_reference t5 USING (workspace_id, warehouse_id)\nORDER BY\n  LastPeriodGrowth DESC;",
      "parameters": [
        {
          "displayName": "number_of_days",
          "keyword": "number_of_days",
          "dataType": "INTEGER",
          "defaultSelection": {
            "values": {
              "dataType": "INTEGER",
              "values": [
                {
                  "value": "7"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "e4d4c1ff",
      "displayName": "warehouse_no_tags",
      "query": "WITH billing_data AS (\n  SELECT\n    *,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(sku_name) OVER (\n        PARTITION BY warehouse_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_sku_name,\n    case\n      when usage_end_time is null then null\n      else FIRST_VALUE(custom_tags) OVER (\n        PARTITION BY warehouse_id\n        ORDER BY\n          usage_end_time DESC\n      )\n    end AS recent_tag_value\n  FROM\n    (\n      SELECT\n        t1.*,\n        t1.usage_metadata.warehouse_id AS warehouse_id,\n        t1.usage_quantity * list_prices.pricing.default as list_cost,\n        t1.sku_name,\n        t1.usage_end_time,\n        t1.custom_tags\n      FROM\n        system.billing.usage t1\n        INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n        and t1.sku_name = list_prices.sku_name\n        and t1.usage_start_time >= list_prices.price_start_time\n        and (\n          t1.usage_end_time <= list_prices.price_end_time\n          or list_prices.price_end_time is null\n        )\n      WHERE\n        t1.billing_origin_product = 'SQL'\n        and t1.usage_metadata.warehouse_id is not null\n        AND usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    )\n)\nSELECT\n  t1.workspace_id,\n  t3.workspace_name,\n  t1.warehouse_id,\n  coalesce(t4.warehouse_name, t1.warehouse_id) as warehouse_name,\n  first(t1.recent_tag_value) as tags,\n  first(t1.recent_sku_name) as sku_name,\n  ifnull(\n    {catalog}.{schema}.sql_type_from_sku(first(t1.recent_sku_name)),\n    'UNKNOWN'\n  ) as sql_type_from_sku,\n  sum(t1.list_cost) as list_cost\nFROM\n  billing_data t1\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN {catalog}.{schema}.warehouse_reference t4 USING (workspace_id, warehouse_id)\nGROUP BY\n  ALL\nHAVING\n  cardinality(first(t1.recent_tag_value)) = 0\nORDER BY\n  list_cost DESC;"
    },
    {
      "name": "57a475b4",
      "displayName": "warehouse_scaling",
      "query": "WITH billing_data AS (\n  SELECT\n    t1.workspace_id,\n    t1.usage_metadata.warehouse_id AS warehouse_id,\n    FIRST_VALUE(t1.custom_tags) OVER (\n      PARTITION BY t1.workspace_id,\n      t1.usage_metadata.warehouse_id\n      ORDER BY\n        t1.usage_end_time DESC ROWS BETWEEN UNBOUNDED PRECEDING\n        AND UNBOUNDED FOLLOWING\n    ) AS recent_tag_value,\n    FIRST_VALUE(t1.sku_name) OVER (\n      PARTITION BY t1.workspace_id,\n      t1.usage_metadata.warehouse_id\n      ORDER BY\n        t1.usage_end_time DESC ROWS BETWEEN UNBOUNDED PRECEDING\n        AND UNBOUNDED FOLLOWING\n    ) AS recent_sku_name\n  FROM\n    system.billing.usage t1\n  WHERE\n    t1.billing_origin_product = 'SQL'\n    and t1.usage_metadata.warehouse_id is not null\n),\ngrouped_billing AS (\n  SELECT\n    workspace_id,\n    warehouse_id,\n    first(recent_tag_value) as tags,\n    first(recent_sku_name) as sku_name\n  FROM\n    billing_data\n  group by\n    ALL\n),\nraw_scaling AS (\n  SELECT\n    workspace_id,\n    warehouse_id,\n    date_trunc('MINUTE', event_time) AS event_minute,\n    MAX(w.cluster_count) AS clusters\n  FROM\n    system.compute.warehouse_events w\n  WHERE\n    event_type IN ('RUNNING', 'SCALED_UP', 'SCALED_DOWN', 'STOPPED')\n  GROUP BY\n    workspace_id,\n    warehouse_id,\n    date_trunc('MINUTE', event_time)\n  ORDER BY\n    workspace_id,\n    warehouse_id,\n    event_minute\n),\nmin_max_series AS (\n  SELECT\n    workspace_id,\n    warehouse_id,\n    MIN(event_minute) AS min_event_minute,\n    MAX(event_minute) AS max_event_minute\n  FROM\n    raw_scaling\n  GROUP BY\n    workspace_id,\n    warehouse_id\n),\nfull_series AS (\n  SELECT\n    workspace_id,\n    warehouse_id,\n    explode(\n      sequence(\n        min_event_minute,\n        max_event_minute,\n        INTERVAL 1 MINUTE\n      )\n    ) AS minuteChunk\n  FROM\n    min_max_series\n),\nfilled_in_series AS (\n  SELECT\n    spine.workspace_id,\n    spine.warehouse_id,\n    spine.minuteChunk AS event_minute,\n    MAX(s2.clusters) AS NumberOfClustersOn\n  FROM\n    full_series AS spine\n    LEFT JOIN raw_scaling AS s2 ON date_trunc('minute', s2.event_minute) = spine.minuteChunk\n    AND s2.warehouse_id = spine.warehouse_id\n    AND s2.workspace_id = spine.workspace_id\n  GROUP BY\n    spine.workspace_id,\n    spine.warehouse_id,\n    spine.minuteChunk\n  ORDER BY\n    spine.workspace_id,\n    spine.warehouse_id,\n    event_minute\n)\nSELECT\n  t1.event_minute,\n  t1.workspace_id,\n  t3.workspace_name,\n  t1.warehouse_id,\n  coalesce(t4.warehouse_name, t1.warehouse_id) as warehouse_name,\n  t2.tags as tags,\n  t2.sku_name as sku_name,\n  ifnull(\n    {catalog}.{schema}.sql_type_from_sku(t2.sku_name),\n    'UNKNOWN'\n  ) as sql_type_from_sku,\n  {catalog}.{schema}.team_name_from_tags(t2.tags, null) as team_name,\n  LAST_VALUE(t1.NumberOfClustersOn, true) OVER (\n    PARTITION BY t1.workspace_id,\n    t1.warehouse_id\n    ORDER BY\n      t1.event_minute\n  ) AS NumberOfClustersOn\nFROM\n  filled_in_series t1\n  LEFT JOIN grouped_billing t2 USING (workspace_id, warehouse_id)\n  LEFT JOIN {catalog}.{schema}.workspace_reference t3 USING (workspace_id)\n  LEFT JOIN {catalog}.{schema}.warehouse_reference t4 USING (workspace_id, warehouse_id)\nORDER BY\n  t1.workspace_id,\n  t1.warehouse_id,\n  t1.event_minute;"
    },
    {
      "name": "663d0363",
      "displayName": "most_expensive_queries",
      "query": "WITH raw_history AS (\n  SELECT\n    workspace_id,\n    statement_id,\n    executed_by,\n    statement_text,\n    compute.warehouse_id AS warehouse_id,\n    execution_status,\n    ifnull(statement_type, 'Other') as statement_type,\n    COALESCE(client_application, 'Unknown') AS client_application,\n    COALESCE(try_divide(total_duration_ms, 1000), 0) AS QueryRuntimeSeconds,\n    COALESCE(try_divide(total_task_duration_ms, 1000), 0) AS CPUTotalExecutionTime,\n    COALESCE(try_divide(execution_duration_ms, 1000), 0) AS ExecutionQueryTime,\n    COALESCE(try_divide(compilation_duration_ms, 1000), 0) AS CompilationQueryTime,\n    COALESCE(\n      try_divide(waiting_at_capacity_duration_ms, 1000),\n      0\n    ) AS QueueQueryTime,\n    COALESCE(\n      try_divide(waiting_for_compute_duration_ms, 1000),\n      0\n    ) AS StartUpQueryTime,\n    COALESCE(try_divide(result_fetch_duration_ms, 1000), 0) AS ResultFetchTime,\n    CASE\n      WHEN COALESCE(try_divide(total_task_duration_ms, 1000), 0) = 0 THEN 0\n      ELSE COALESCE(try_divide(total_duration_ms, 1000), 0) + COALESCE(try_divide(compilation_duration_ms, 1000), 0) -- Query total time is compile time + execution time\n    END AS TotalResourceTimeUsedForAllocation,\n    start_time,\n    end_time,\n    update_time,\n    COALESCE(read_bytes, 0) AS read_bytes,\n    COALESCE(read_io_cache_percent, 0) AS read_io_cache_percent,\n    from_result_cache,\n    COALESCE(spilled_local_bytes, 0) AS spilled_local_bytes,\n    COALESCE(total_task_duration_ms / total_duration_ms, NULL) AS TotalCPUTime_To_Execution_Time_Ratio,\n    COALESCE(\n      waiting_at_capacity_duration_ms / total_duration_ms,\n      0\n    ) AS ProportionQueueTime,\n    AVG(try_divide(total_duration_ms, 1000)) OVER () AS WarehouseAvgQueryRuntime,\n    AVG(\n      try_divide(waiting_at_capacity_duration_ms, 1000)\n    ) OVER () AS WarehouseAvgQueueTime,\n    AVG(\n      COALESCE(\n        try_divide(waiting_at_capacity_duration_ms, 1000) / try_divide(total_duration_ms, 1000),\n        0\n      )\n    ) OVER () AS WarehouseAvgProportionTimeQueueing,\n    CASE\n      WHEN read_bytes > 0 THEN try_divide(read_bytes,(1024 * 1024 * 1024))\n      ELSE 0\n    END AS ReadDataAmountInGB,\n    CASE\n      WHEN read_io_cache_percent > 0 THEN 'Used Cache'\n      ELSE 'No Cache'\n    END AS UsedCacheFlag,\n    CASE\n      WHEN spilled_local_bytes > 0 THEN 'Spilled Data To Disk'\n      ELSE 'No Spill'\n    END AS HasSpillFlag,\n    CASE\n      WHEN read_bytes > 0 THEN 'Did Read Data'\n      ELSE 'No Data Read'\n    END AS ReadDataFlag,\n    CASE\n      WHEN CPUTotalExecutionTime > 0 THEN 'UsedWorkerTasks'\n      ELSE 'NoWorkers'\n    END AS UsedWorkerTasksFlag,\n    CASE\n      WHEN spilled_local_bytes > 0 THEN 1\n      ELSE 0\n    END AS Calc_HasSpillFlag,\n    CASE\n      WHEN read_bytes > 0 THEN 0.25\n      ELSE 0\n    END AS Calc_ReadDataFlag,\n    CASE\n      WHEN CPUTotalExecutionTime > 0 THEN 0.25\n      ELSE 0\n    END AS Calc_UsedWorkerTasksFlag\n  FROM\n    system.query.history f\n  WHERE\n    date(start_time) < CURRENT_DATE()\n),\nhistory AS (\n  SELECT\n    *,\n    SUM(TotalResourceTimeUsedForAllocation) OVER () AS TotalUsedTimeInWarehouse,\n    SUM(COALESCE(TotalResourceTimeUsedForAllocation, 0)) OVER (PARTITION BY statement_text) AS TotalStatementTextTimeUsed,\n    try_divide(\n      TotalResourceTimeUsedForAllocation,\n      TotalUsedTimeInWarehouse\n    ) AS ProportionOfWarehouseTimeUsedByQuery\n  FROM\n    raw_history\n),\nfiltered_warehouse_usage AS (\n  SELECT\n    t1.workspace_id,\n    t1.usage_metadata.warehouse_id,\n    SUM(t1.usage_quantity) as Total_Warehouse_Period_DBUs,\n    SUM(t1.usage_quantity * list_prices.pricing.default) as Total_Warehouse_Period_Dollars\n  FROM\n    system.billing.usage t1\n    INNER JOIN system.billing.list_prices list_prices on t1.cloud = list_prices.cloud\n    and t1.sku_name = list_prices.sku_name\n    and t1.usage_start_time >= list_prices.price_start_time\n    and (\n      t1.usage_end_time <= list_prices.price_end_time\n      or list_prices.price_end_time is null\n    )\n  WHERE\n    t1.billing_origin_product = 'SQL'\n    AND t1.usage_metadata.warehouse_id IS NOT NULL\n  GROUP BY\n    ALL\n),\ncustom_tag AS (\n  with tag_data as (\n    SELECT\n      workspace_id,\n      usage_metadata.warehouse_id as warehouse_id,\n      {catalog}.{schema}.team_name_from_tags(custom_tags, null) as team_name\n    from\n      system.billing.usage\n    WHERE\n      billing_origin_product = 'SQL'\n      AND usage_metadata.warehouse_id IS NOT NULL\n  )\n  select\n    workspace_id,\n    warehouse_id,\n    max(team_name) as team_name\n  from\n    tag_data\n  GROUP BY\n    workspace_id,\n    warehouse_id\n),\nsku_from_billing AS (\n  SELECT\n    u.workspace_id,\n    u.usage_metadata.warehouse_id as warehouse_id,\n    u.sku_name,\n    max(t1.team_name) as team_name,\n    min(u.usage_start_time) as usage_start_time,\n    max(u.usage_end_time) as usage_end_time\n  from\n    system.billing.usage u\n    LEFT JOIN custom_tag AS t1 ON u.workspace_id = t1.workspace_id\n    and u.usage_metadata.warehouse_id = t1.warehouse_id\n  WHERE\n    u.billing_origin_product = 'SQL'\n    AND u.usage_metadata.warehouse_id IS NOT NULL\n  GROUP BY\n    u.workspace_id,\n    u.usage_metadata.warehouse_id,\n    sku_name\n),\nquery_level_intel_metrics AS (\n  SELECT\n    qh.*,\n    s.sku_name,\n    s.team_name,\n    t2.workspace_name,\n    coalesce(t1.warehouse_name, qh.warehouse_id) as warehouse_name,\n    u.Total_Warehouse_Period_Dollars,\n    (\n      u.Total_Warehouse_Period_Dollars :: float * ProportionOfWarehouseTimeUsedByQuery :: float\n    ) AS AllocatedQueryCostByTime,\n    ifnull(\n      {catalog}.{schema}.sql_type_from_sku(sku_name),\n      'UNKNOWN'\n    ) as sql_type_from_sku\n  FROM\n    history AS qh\n    LEFT JOIN filtered_warehouse_usage AS u USING (workspace_id, warehouse_id)\n    LEFT JOIN sku_from_billing AS s ON qh.warehouse_id = s.warehouse_id\n    AND qh.workspace_id = s.workspace_id\n    AND qh.start_time < s.usage_end_time\n    AND qh.end_time > s.usage_start_time\n    LEFT JOIN {catalog}.{schema}.warehouse_reference t1 USING (workspace_id, warehouse_id)\n    LEFT JOIN {catalog}.{schema}.workspace_reference t2 USING (workspace_id)\n)\nSELECT\n  *\nFROM\n  query_level_intel_metrics\norder by\n  AllocatedQueryCostByTime DESC\nLIMIT 1000;"
    }
  ],
  "pages": [
    {
      "name": "3c10256d",
      "displayName": "New Page",
      "layout": [
        {
          "widget": {
            "name": "6064a1e4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "sum(Last30to60DaySpend)",
                      "expression": "SUM(`Last30to60DaySpend`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(Last30to60DaySpend)",
                  "displayName": "Sum of Last30to60DaySpend"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Previous 30 Day $list Spend",
                "showDescription": true,
                "description": "Spend in the prior 30 days (i.e., days 31\u201360 before the current date)"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 17,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "8db952ae",
            "queries": [
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5140b9c871e37c5a98b89_usage_date",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "usage_date_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5143492dc723962acedd8_end_time",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "end_time",
                      "expression": "`end_time`"
                    },
                    {
                      "name": "end_time_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5146089d5de2ccffeeb1d_event_minute",
                "query": {
                  "datasetName": "57a475b4",
                  "fields": [
                    {
                      "name": "event_minute",
                      "expression": "`event_minute`"
                    },
                    {
                      "name": "event_minute_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "usage_date",
                    "displayName": "usage_date",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5140b9c871e37c5a98b89_usage_date"
                  },
                  {
                    "fieldName": "end_time",
                    "displayName": "end_time",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5143492dc723962acedd8_end_time"
                  },
                  {
                    "fieldName": "event_minute",
                    "displayName": "event_minute",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5146089d5de2ccffeeb1d_event_minute"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATETIME",
                    "min": {
                      "value": "now-14d/d"
                    },
                    "max": {
                      "value": "now-1d/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Date Range"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "20d6788a",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "daily(usage_end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `usage_end_time`)"
                    },
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(usage_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "date"
                },
                "y": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "$list"
                  },
                  "displayName": "$DBU"
                },
                "color": {
                  "fieldName": "sku_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "sku_name"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Daily $list by SKU",
                "showDescription": true,
                "description": "Daily spend per SKU (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 21,
            "width": 4,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "a89a7010",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "daily(usage_end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `usage_end_time`)"
                    },
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(usage_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "date"
                },
                "y": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "$list"
                  },
                  "displayName": "$DBU"
                },
                "color": {
                  "fieldName": "workspace_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "workspace_name"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Daily $list by Workspace",
                "showDescription": true,
                "description": "Daily spend per workspace (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 17,
            "width": 4,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "9e95503d",
            "queries": [
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef9248627b1e87ba5c071a8fa8992f_workspace_name",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed610468faafdc040c1f8a3_workspace_name",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92615ea9130e97b71e1cda3726a0_workspace_name",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92676f581a2f8891387302f271c4_workspace_name",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef926b89d11f4c9b988aaa44027239_workspace_name",
                "query": {
                  "datasetName": "57a475b4",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed61069bcb45afa18aff8c1_workspace_name",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed610849937b2544dd98ee1_workspace_name",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef9248627b1e87ba5c071a8fa8992f_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed610468faafdc040c1f8a3_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92615ea9130e97b71e1cda3726a0_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92676f581a2f8891387302f271c4_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef926b89d11f4c9b988aaa44027239_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed61069bcb45afa18aff8c1_workspace_name"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "workspace_name",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed610849937b2544dd98ee1_workspace_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace Name"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 10,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "07ff9fe2",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "sum(Last30DaySpend)",
                      "expression": "SUM(`Last30DaySpend`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(Last30DaySpend)",
                  "displayName": "Sum of Last30DaySpend"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30 Day $list Spend",
                "showDescription": true,
                "description": "Spend in the last 30 days"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 17,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "0a7f14c8",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "bb7e5c78",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    },
                    {
                      "name": "weekly_growth",
                      "expression": "`weekly_growth`"
                    },
                    {
                      "name": "3_months_growth_moving_avg",
                      "expression": "`3_months_growth_moving_avg`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "combo",
              "encodings": {
                "x": {
                  "fieldName": "week_start",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "week_start"
                },
                "y": {
                  "primary": {
                    "fields": [
                      {
                        "fieldName": "weekly_growth",
                        "displayName": "weekly %change"
                      }
                    ]
                  },
                  "secondary": {
                    "fields": [
                      {
                        "fieldName": "3_months_growth_moving_avg",
                        "displayName": "3_months_growth_moving_avg"
                      }
                    ]
                  },
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "WoW $list %change",
                "showDescription": true,
                "description": "Week over Week change in query cost percentage (y-axis) with time (x-axis)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 25,
            "width": 4,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "e8fc41c4",
            "textbox_spec": "### DBSQL Comprehensive Cost and Performance Analysis Dashboard\n----\nThis dashboard offers a unified view of cost, query, and warehouse performance metrics, enabling data teams to efficiently monitor, analyze, and optimize resource usage for DBSQL. The dashboard consists of four primary sections, each enhanced by global filters that allow users to customize views across all sections.\n\n#### Dashboard Filters\n\n- **Date Range**: Select a specific date range to analyze historical data, allowing for flexible time-based insights across costs, queries, and warehouse performance.\n  \n- **Workspace Name**: Filter by workspace to view costs, query activities, and warehouse metrics specific to individual workspaces, providing a focused view of workspace-level performance and spending.\n\n- **SQL Type**: Apply filters based on SQL Warehouse SKU types (e.g., Classic, Pro, or Serverless), making it easy to assess performance and cost impacts by SKU type across the data environment.\n\n- **Warehouse ID and Warehouse Name**: These filters allow users to drill down into specific warehouses, viewing metrics such as resource utilization, costs, and performance changes related to selected warehouses.\n\n- **Team Name**: Filter by team to see resource usage and costs attributed to specific teams, facilitating team-based analysis and accountability for resource consumption. The team name is based on the tags added to the warehouses.\n\n#### Dashboard Sections\n\n1. **Cost Breakdown and Usage Analysis**: Visual and tabular insights into daily costs by workspace, SKU, team, and individual users, along with details on high-cost queries. This section provides visibility into cost distribution and spending trends.\n\n2. **Cost Comparison and Change Analysis**: A comparison of costs over user-defined timeframes, allowing teams to track spending changes and analyze warehouse-level cost fluctuations, facilitating targeted cost control.\n\n3. **Query Analysis**: Detailed views of query counts, statuses, run times, and sources, helping identify performance bottlenecks and optimize query efficiency across workspaces and applications.\n\n4. **Warehouse Analysis**: Insights into warehouse usage, including uptime, spill occurrences, and untagged resources, providing data to support efficient scaling and resource management.\n\nTogether, these sections and filters provide a holistic view of resource consumption, cost patterns, and performance trends, empowering teams to make data-driven decisions to optimize data environment usage and reduce operational costs.\n\n#### System Tables Used\n- system.billing.usage\n- system.billing.list_prices\n- system.query.history\n- system.compute.warehouse_events\n\n"
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 10
          }
        },
        {
          "widget": {
            "name": "3ae9678c",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    },
                    {
                      "name": "tagbucket",
                      "expression": "`tagbucket`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of list_cost"
                },
                "color": {
                  "fieldName": "tagbucket",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "ohhla",
                        "color": "#AB4057"
                      }
                    ]
                  },
                  "displayName": "tagbucket"
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Rolling 30 $list by Team",
                "showDescription": true,
                "description": "Cost per team name tag attributed by queries"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 19,
            "width": 2,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "ce1f6f7a",
            "queries": [
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed610468faafdc040c1f8a3_sql_type_from_sku",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "sql_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed61069bcb45afa18aff8c1_sql_type_from_sku",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "sql_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed610849937b2544dd98ee1_sql_type_from_sku",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "sql_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef9248627b1e87ba5c071a8fa8992f_sql_type_from_sku",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "sql_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92615ea9130e97b71e1cda3726a0_sql_type_from_sku",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "sql_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92676f581a2f8891387302f271c4_sql_type_from_sku",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "sql_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef926b89d11f4c9b988aaa44027239_sql_type_from_sku",
                "query": {
                  "datasetName": "57a475b4",
                  "fields": [
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "sql_type_from_sku_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "sql_type_from_sku",
                    "displayName": "sql_type_from_sku",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed610468faafdc040c1f8a3_sql_type_from_sku"
                  },
                  {
                    "fieldName": "sql_type_from_sku",
                    "displayName": "sql_type_from_sku",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed61069bcb45afa18aff8c1_sql_type_from_sku"
                  },
                  {
                    "fieldName": "sql_type_from_sku",
                    "displayName": "sql_type_from_sku",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef915a5ed610849937b2544dd98ee1_sql_type_from_sku"
                  },
                  {
                    "fieldName": "sql_type_from_sku",
                    "displayName": "sql_type_from_sku",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef9248627b1e87ba5c071a8fa8992f_sql_type_from_sku"
                  },
                  {
                    "fieldName": "sql_type_from_sku",
                    "displayName": "sql_type_from_sku",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92615ea9130e97b71e1cda3726a0_sql_type_from_sku"
                  },
                  {
                    "fieldName": "sql_type_from_sku",
                    "displayName": "sql_type_from_sku",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92676f581a2f8891387302f271c4_sql_type_from_sku"
                  },
                  {
                    "fieldName": "sql_type_from_sku",
                    "displayName": "sql_type_from_sku",
                    "queryName": "dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef926b89d11f4c9b988aaa44027239_sql_type_from_sku"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "SQL Type"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 10,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "c70af7db",
            "queries": [
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5140b9c871e37c5a98b89_team_name",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5141a9b506be4e8898404_team_name",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5143492dc723962acedd8_team_name",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5144480903ff722af923a_team_name",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5146089d5de2ccffeeb1d_team_name",
                "query": {
                  "datasetName": "57a475b4",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "team_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5140b9c871e37c5a98b89_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5141a9b506be4e8898404_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5143492dc723962acedd8_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5144480903ff722af923a_team_name"
                  },
                  {
                    "fieldName": "team_name",
                    "displayName": "team_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5146089d5de2ccffeeb1d_team_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Team Name"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 11,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "e021dd13",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "weekly(usage_end_time)",
                      "expression": "DATE_TRUNC(\"WEEK\", `usage_end_time`)"
                    },
                    {
                      "name": "sum(list_cost)",
                      "expression": "SUM(`list_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "weekly(usage_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "usage_end_time"
                },
                "y": {
                  "fieldName": "sum(list_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of list_cost"
                },
                "color": {
                  "fieldName": "team_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "team_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Weekly $list by Tag",
                "description": "Daily spend per team (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 25,
            "width": 2,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "30d409da",
            "queries": [
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5140b9c871e37c5a98b89_warehouse_id",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "warehouse_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5141a9b506be4e8898404_warehouse_id",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "warehouse_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e514278ee009144a63be45_warehouse_id",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "warehouse_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5143492dc723962acedd8_warehouse_id",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "warehouse_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5144480903ff722af923a_warehouse_id",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "warehouse_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e514549befa91b826c9472_warehouse_id",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "warehouse_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5146089d5de2ccffeeb1d_warehouse_id",
                "query": {
                  "datasetName": "57a475b4",
                  "fields": [
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "warehouse_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "warehouse_id",
                    "displayName": "warehouse_id",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5140b9c871e37c5a98b89_warehouse_id"
                  },
                  {
                    "fieldName": "warehouse_id",
                    "displayName": "warehouse_id",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5141a9b506be4e8898404_warehouse_id"
                  },
                  {
                    "fieldName": "warehouse_id",
                    "displayName": "warehouse_id",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e514278ee009144a63be45_warehouse_id"
                  },
                  {
                    "fieldName": "warehouse_id",
                    "displayName": "warehouse_id",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5143492dc723962acedd8_warehouse_id"
                  },
                  {
                    "fieldName": "warehouse_id",
                    "displayName": "warehouse_id",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5144480903ff722af923a_warehouse_id"
                  },
                  {
                    "fieldName": "warehouse_id",
                    "displayName": "warehouse_id",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e514549befa91b826c9472_warehouse_id"
                  },
                  {
                    "fieldName": "warehouse_id",
                    "displayName": "warehouse_id",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5146089d5de2ccffeeb1d_warehouse_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Id"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 11,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "09f72163",
            "queries": [
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5140b9c871e37c5a98b89_warehouse_name",
                "query": {
                  "datasetName": "07398605",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5141a9b506be4e8898404_warehouse_name",
                "query": {
                  "datasetName": "0655a5b3",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e514278ee009144a63be45_warehouse_name",
                "query": {
                  "datasetName": "11611f07",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5143492dc723962acedd8_warehouse_name",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5144480903ff722af923a_warehouse_name",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e514549befa91b826c9472_warehouse_name",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5146089d5de2ccffeeb1d_warehouse_name",
                "query": {
                  "datasetName": "57a475b4",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "warehouse_name",
                    "displayName": "warehouse_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5140b9c871e37c5a98b89_warehouse_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "displayName": "warehouse_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5141a9b506be4e8898404_warehouse_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "displayName": "warehouse_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e514278ee009144a63be45_warehouse_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "displayName": "warehouse_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5143492dc723962acedd8_warehouse_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "displayName": "warehouse_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5144480903ff722af923a_warehouse_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "displayName": "warehouse_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e514549befa91b826c9472_warehouse_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "displayName": "warehouse_name",
                    "queryName": "dashboards/01ef931977ca1d4192c486b03938dd4d/datasets/01ef931cf1e5146089d5de2ccffeeb1d_warehouse_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Name"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 11,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "170c8e2e",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "countdistinct(warehouse_id)",
                      "expression": "COUNT(DISTINCT `warehouse_id`)"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "countdistinct(warehouse_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of warehouses"
                },
                "color": {
                  "fieldName": "workspace_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "workspace_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Warehouse count",
                "description": "Warehouse count comparison in workspaces"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 80,
            "width": 1,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "711ac670",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "countdistinct(statement_id)",
                      "expression": "COUNT(DISTINCT `statement_id`)"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "countdistinct(statement_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of query runs"
                },
                "color": {
                  "fieldName": "workspace_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "workspace_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Query count",
                "description": "Query count comparison in workspaces"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 53,
            "width": 1,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "28e1fd8a",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "avg(QueryRuntime_P50)",
                      "expression": "AVG(`QueryRuntime_P50`)"
                    },
                    {
                      "name": "avg(QueryRuntime_P90)",
                      "expression": "AVG(`QueryRuntime_P90`)"
                    },
                    {
                      "name": "avg(QueryRuntime_P95)",
                      "expression": "AVG(`QueryRuntime_P95`)"
                    },
                    {
                      "name": "avg(QueryRuntime_P99)",
                      "expression": "AVG(`QueryRuntime_P99`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "avg(QueryRuntime_P50)",
                      "displayName": "P50"
                    },
                    {
                      "fieldName": "avg(QueryRuntime_P90)",
                      "displayName": "P90"
                    },
                    {
                      "fieldName": "avg(QueryRuntime_P95)",
                      "displayName": "P95"
                    },
                    {
                      "fieldName": "avg(QueryRuntime_P99)",
                      "displayName": "P99"
                    }
                  ]
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Query runtime percentile",
                "description": "Percentile runtime comparison of queries"
              },
              "mark": {
                "layout": "group"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 53,
            "width": 2,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "f59c10eb",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "countdistinct(statement_id)",
                      "expression": "COUNT(DISTINCT `statement_id`)"
                    },
                    {
                      "name": "client_application",
                      "expression": "`client_application`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "countdistinct(statement_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of Unique statement_id"
                },
                "y": {
                  "fieldName": "client_application",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "client_application"
                },
                "color": {
                  "fieldName": "sku_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "sku_name"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Queries By Source App",
                "showDescription": true,
                "description": "Count of queries per client application"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 63,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "df639466",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "execution_status",
                      "expression": "`execution_status`"
                    },
                    {
                      "name": "hourly(end_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `end_time`)"
                    },
                    {
                      "name": "countdistinct(statement_id)",
                      "expression": "COUNT(DISTINCT `statement_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "hourly(end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "end_time"
                },
                "y": {
                  "fieldName": "countdistinct(statement_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of Unique statement_id"
                },
                "color": {
                  "fieldName": "execution_status",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "execution_status"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Hourly Run Status Distribution",
                "description": "Breakup of query status as percentage (y-axis) over time (x-axis)"
              },
              "mark": {
                "layout": "percent-stack"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 69,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "6bbea12d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "daily(end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `end_time`)"
                    },
                    {
                      "name": "sum(QueryRuntimeSeconds)",
                      "expression": "SUM(`QueryRuntimeSeconds`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "end_time"
                },
                "y": {
                  "fieldName": "sum(QueryRuntimeSeconds)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of QueryRuntimeSeconds"
                },
                "color": {
                  "fieldName": "warehouse_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "warehouse_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "description": "Breakup of runtime in seconds (y-axis) over time (x-axis)",
                "title": "Query Runtime per Day"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 65,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "52a216da",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "daily(end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `end_time`)"
                    },
                    {
                      "name": "countdistinct(statement_id)",
                      "expression": "COUNT(DISTINCT `statement_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "daily(end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "end_time"
                },
                "y": {
                  "fieldName": "countdistinct(statement_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of Unique statement_id"
                },
                "color": {
                  "fieldName": "team_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "team_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Query run count with time",
                "description": "Number of queries runs (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 70,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "41a12c74",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "daily(end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `end_time`)"
                    },
                    {
                      "name": "avg(QueryRuntimeSeconds)",
                      "expression": "AVG(`QueryRuntimeSeconds`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "end_time"
                },
                "y": {
                  "fieldName": "avg(QueryRuntimeSeconds)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Average QueryRuntimeSeconds"
                },
                "color": {
                  "fieldName": "sku_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "sku_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Query Run Time Trend",
                "description": "Average query run time (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 58,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "d31686e0",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "daily(end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `end_time`)"
                    },
                    {
                      "name": "avg(QueueQueryTime)",
                      "expression": "AVG(`QueueQueryTime`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "end_time"
                },
                "y": {
                  "fieldName": "avg(QueueQueryTime)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Average QueueQueryTime"
                },
                "color": {
                  "fieldName": "sku_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "sku_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Query Queue Time Trend",
                "description": "Average query queue time (y-axis) over time (x-axis)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 53,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "f94aaa24",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "avg(QueryRuntimeSeconds)",
                      "expression": "AVG(`QueryRuntimeSeconds`)"
                    },
                    {
                      "name": "execution_status",
                      "expression": "`execution_status`"
                    },
                    {
                      "name": "statement_type",
                      "expression": "`statement_type`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "execution_status",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "execution_status"
                },
                "y": {
                  "fieldName": "statement_type",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "statement_type"
                },
                "color": {
                  "fieldName": "avg(QueryRuntimeSeconds)",
                  "scale": {
                    "type": "quantitative",
                    "colorRamp": {
                      "mode": "scheme",
                      "scheme": "greenblue"
                    }
                  },
                  "displayName": "Avg Time sec"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Query Runtime By Statement Type and Status",
                "description": "Query runtime distribution with statement type (y-axis) and execution status (x-axis)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 58,
            "width": 3,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "64642f78",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "sum(AllocatedQueryCostByTime)",
                      "expression": "SUM(`AllocatedQueryCostByTime`)"
                    },
                    {
                      "name": "executed_by",
                      "expression": "`executed_by`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(AllocatedQueryCostByTime)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of AllocatedQueryCostByTime"
                },
                "color": {
                  "fieldName": "executed_by",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "executed_by"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Allocated Query Cost By User",
                "description": "Query run cost per user"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 30,
            "width": 2,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "65c8fbac",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "566012fa",
                  "fields": [
                    {
                      "name": "HasSpillFlag",
                      "expression": "`HasSpillFlag`"
                    },
                    {
                      "name": "daily(end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `end_time`)"
                    },
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "end_time"
                },
                "y": {
                  "fieldName": "count(*)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of Records"
                },
                "color": {
                  "fieldName": "HasSpillFlag",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "HasSpillFlag"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Queries With Spill",
                "description": "Number of queries with and without spill (y-axis) with time (x-axis)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 80,
            "width": 2,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "88433c9b",
            "textbox_spec": "### Cost Breakdown and Usage Analysis Section\n----\nThis section provides a visual and tabular breakdown of daily costs across various dimensions, offering insights into cost drivers and usage patterns. Key elements include:\n\n1. **Daily Cost by Workspace and SKU**: Charts that display daily cost trends, organized by workspace and SKU, to help identify the primary sources of daily expenditures.\n\n2. **Cost by Team**: A breakdown of costs by team, enabling teams to understand their individual contributions to overall spending.\n\n3. **Cost Allocated by Users**: Chart showing costs attributed to specific users, providing clarity on user-level resource utilization and potential areas for optimization.\n\n4. **Week-over-Week Cost Change**: A visual comparison of weekly cost fluctuations, allowing users to quickly assess spending changes and track efforts to control costs.\n\n5. **Expensive Queries Table**: A table listing the most expensive queries, detailing execution times, costs, and query sources, enabling targeted optimization of high-cost operations.\n\nThis section provides essential insights into cost distribution and utilization, supporting efficient resource management and cost control efforts across the organization.\n"
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "3ce0d928",
            "textbox_spec": "### Query Analysis Section\n----\nThis section offers a comprehensive view of query activity and performance across workspaces, helping teams analyze and optimize query behavior. Key visualizations include:\n\n1. **Query Count per Workspace**: A breakdown of the number of queries executed per workspace, offering insights into query distribution and activity levels.\n\n2. **Query Status Overview**: Charts summarizing query statuses (e.g., completed, failed, in progress) to help monitor operational reliability and troubleshoot query issues.\n\n3. **Query Run Time and Queue Time**: Visuals showing the average and total time queries spend running and in queue, helping identify bottlenecks and optimize processing times.\n\n4. **Query Time by Statement Type and Status**: A breakdown of query times by statement type (e.g., SELECT, INSERT) and execution status, providing granular insights into which types of queries consume the most resources.\n\n5. **Queries by Source Application**: A view of query counts by source application, revealing which applications drive the highest query volumes and potentially require further resource allocation.\n\nThis section aids in understanding and managing query performance, supporting optimizations to enhance overall data processing efficiency and reduce resource strain.\n"
          },
          "position": {
            "x": 0,
            "y": 48,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "71ccb23c",
            "textbox_spec": "### Warehouse Analysis Section\n----\nThis section provides insights into warehouse usage and efficiency, helping teams optimize resource allocation and performance. Key components include:\n\n1. **Warehouse Count per Workspace**: Charts displaying the number of warehouses used across workspaces, offering visibility into workspace-specific warehouse demands.\n\n2. **Cluster Uptime Percentage**: A breakdown of the percentage of time clusters remained active, highlighting resource utilization levels and potential optimization opportunities.\n\n3. **Query Spill Over Time**: Visuals tracking query spill occurrences over time, helping identify performance issues caused by insufficient memory and guiding resource adjustments.\n\n4. **Cluster Count per Warehouse**: Data showing the number of clusters allocated per warehouse, assisting in analyzing load distribution and identifying areas for scaling.\n\n5. **Untagged Warehouses**: A listing of warehouses without tags, encouraging proper tagging practices to improve tracking, billing accuracy, and resource allocation.\n\nThis section supports effective warehouse management, allowing for better scaling, cost-efficiency, and streamlined operations across the data environment.\n"
          },
          "position": {
            "x": 0,
            "y": 75,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "ebe52478",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "sum(LastPeriodSpend)",
                      "expression": "SUM(`LastPeriodSpend`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(LastPeriodSpend)",
                  "displayName": "Sum of LastPeriodSpend"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Last Period $list Spend",
                "description": "Spend in the above period"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 44,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "c7bc6bad",
            "queries": [
              {
                "name": "parameter_dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92615ea9130e97b71e1cda3726a0_number_of_days",
                "query": {
                  "datasetName": "12c6b9d3",
                  "parameters": [
                    {
                      "name": "number_of_days",
                      "keyword": "number_of_days"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "number_of_days",
                    "queryName": "parameter_dashboards/01ef915a5ed01f189abebbc73380851a/datasets/01ef92615ea9130e97b71e1cda3726a0_number_of_days"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Number of days to compare in the next table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 42,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "786bde8d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "sum(OlderPeriodSpend)",
                      "expression": "SUM(`OlderPeriodSpend`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(OlderPeriodSpend)",
                  "displayName": "Sum of OlderPeriodSpend"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Older Period $list Spend",
                "description": "Spend in the previous period"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 46,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "15b7acad",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "12c6b9d3",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "run_as",
                      "expression": "`run_as`"
                    },
                    {
                      "name": "LastPeriodSpend",
                      "expression": "`LastPeriodSpend`"
                    },
                    {
                      "name": "OlderPeriodSpend",
                      "expression": "`OlderPeriodSpend`"
                    },
                    {
                      "name": "LastPeriodGrowth",
                      "expression": "`LastPeriodGrowth`"
                    },
                    {
                      "name": "LastPeriodGrowthPct",
                      "expression": "`LastPeriodGrowthPct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "warehouse_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "warehouse_name"
                  },
                  {
                    "fieldName": "warehouse_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "warehouse_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "warehouse_id"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "sql_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "sql_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "sql_type_from_sku"
                  },
                  {
                    "fieldName": "run_as",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 6,
                    "title": "run_as",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_as"
                  },
                  {
                    "fieldName": "LastPeriodSpend",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 8,
                    "title": "LastPeriodSpend",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "LastPeriodSpend"
                  },
                  {
                    "fieldName": "OlderPeriodSpend",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 9,
                    "title": "OlderPeriodSpend",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "OlderPeriodSpend"
                  },
                  {
                    "fieldName": "LastPeriodGrowth",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 10,
                    "title": "LastPeriodGrowth",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "LastPeriodGrowth"
                  },
                  {
                    "fieldName": "LastPeriodGrowthPct",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 11,
                    "title": "LastPeriodGrowthPct",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": null
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "LastPeriodGrowthPct",
                            "fn": ">",
                            "literal": "30"
                          },
                          "value": {
                            "foregroundColor": "#FF3621"
                          }
                        }
                      ]
                    },
                    "displayName": "LastPeriodGrowthPct"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "sku_name",
                  "type": "string",
                  "displayAs": "string",
                  "order": 7,
                  "title": "sku_name",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Highest change in monthly $list",
                "description": "Tabular details of what has changed per warehouse in the given period"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 42,
            "width": 5,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "1cb0835b",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "663d0363",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "statement_id",
                      "expression": "`statement_id`"
                    },
                    {
                      "name": "warehouse_id",
                      "expression": "`warehouse_id`"
                    },
                    {
                      "name": "executed_by",
                      "expression": "`executed_by`"
                    },
                    {
                      "name": "team_name",
                      "expression": "`team_name`"
                    },
                    {
                      "name": "statement_text",
                      "expression": "`statement_text`"
                    },
                    {
                      "name": "execution_status",
                      "expression": "`execution_status`"
                    },
                    {
                      "name": "sql_type_from_sku",
                      "expression": "`sql_type_from_sku`"
                    },
                    {
                      "name": "QueryRuntimeSeconds",
                      "expression": "`QueryRuntimeSeconds`"
                    },
                    {
                      "name": "start_time",
                      "expression": "`start_time`"
                    },
                    {
                      "name": "ReadDataAmountInGB",
                      "expression": "`ReadDataAmountInGB`"
                    },
                    {
                      "name": "HasSpillFlag",
                      "expression": "`HasSpillFlag`"
                    },
                    {
                      "name": "ProportionOfWarehouseTimeUsedByQuery",
                      "expression": "`ProportionOfWarehouseTimeUsedByQuery`"
                    },
                    {
                      "name": "AllocatedQueryCostByTime",
                      "expression": "`AllocatedQueryCostByTime`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "workspace_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "warehouse_name",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "warehouse_name"
                  },
                  {
                    "fieldName": "statement_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "statement_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "statement_id"
                  },
                  {
                    "fieldName": "warehouse_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "warehouse_id",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "warehouse_id"
                  },
                  {
                    "fieldName": "executed_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "executed_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "executed_by"
                  },
                  {
                    "fieldName": "team_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 6,
                    "title": "team_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "team_name"
                  },
                  {
                    "fieldName": "statement_text",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 7,
                    "title": "statement_text",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "statement_text"
                  },
                  {
                    "fieldName": "execution_status",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 9,
                    "title": "execution_status",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "execution_status"
                  },
                  {
                    "fieldName": "sql_type_from_sku",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 10,
                    "title": "sql_type_from_sku",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "sql_type_from_sku"
                  },
                  {
                    "fieldName": "QueryRuntimeSeconds",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 13,
                    "title": "QueryRuntimeSeconds",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "QueryRuntimeSeconds"
                  },
                  {
                    "fieldName": "start_time",
                    "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 21,
                    "title": "start_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "start_time"
                  },
                  {
                    "fieldName": "ReadDataAmountInGB",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 33,
                    "title": "ReadDataAmountInGB",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "ReadDataAmountInGB"
                  },
                  {
                    "fieldName": "HasSpillFlag",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 35,
                    "title": "HasSpillFlag",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "HasSpillFlag"
                  },
                  {
                    "fieldName": "ProportionOfWarehouseTimeUsedByQuery",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 43,
                    "title": "ProportionOfWarehouseTimeUsedByQuery",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "ProportionOfWarehouseTimeUsedByQuery"
                  },
                  {
                    "fieldName": "AllocatedQueryCostByTime",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 53,
                    "title": "AllocatedQueryCostByTime",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "AllocatedQueryCostByTime"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 2,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "sku_name",
                  "type": "string",
                  "displayAs": "string",
                  "order": 8,
                  "title": "sku_name",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "statement_type",
                  "type": "string",
                  "displayAs": "string",
                  "order": 11,
                  "title": "statement_type",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "client_application",
                  "type": "string",
                  "displayAs": "string",
                  "order": 12,
                  "title": "client_application",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "CPUTotalExecutionTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 14,
                  "title": "CPUTotalExecutionTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "ExecutionQueryTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 15,
                  "title": "ExecutionQueryTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "CompilationQueryTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 16,
                  "title": "CompilationQueryTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueueQueryTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 17,
                  "title": "QueueQueryTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "StartUpQueryTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 18,
                  "title": "StartUpQueryTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "ResultFetchTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 19,
                  "title": "ResultFetchTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "TotalResourceTimeUsedForAllocation",
                  "type": "float",
                  "displayAs": "number",
                  "order": 20,
                  "title": "TotalResourceTimeUsedForAllocation",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "end_time",
                  "type": "datetime",
                  "displayAs": "datetime",
                  "order": 22,
                  "title": "end_time",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "update_time",
                  "type": "datetime",
                  "displayAs": "datetime",
                  "order": 23,
                  "title": "update_time",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "read_bytes",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 24,
                  "title": "read_bytes",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "read_io_cache_percent",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 25,
                  "title": "read_io_cache_percent",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "from_result_cache",
                  "type": "boolean",
                  "displayAs": "boolean",
                  "order": 26,
                  "title": "from_result_cache",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "spilled_local_bytes",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 27,
                  "title": "spilled_local_bytes",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "TotalCPUTime_To_Execution_Time_Ratio",
                  "type": "float",
                  "displayAs": "number",
                  "order": 28,
                  "title": "TotalCPUTime_To_Execution_Time_Ratio",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "ProportionQueueTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 29,
                  "title": "ProportionQueueTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgQueryRuntime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 30,
                  "title": "WarehouseAvgQueryRuntime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgQueueTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 31,
                  "title": "WarehouseAvgQueueTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgProportionTimeQueueing",
                  "type": "float",
                  "displayAs": "number",
                  "order": 32,
                  "title": "WarehouseAvgProportionTimeQueueing",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "UsedCacheFlag",
                  "type": "string",
                  "displayAs": "string",
                  "order": 34,
                  "title": "UsedCacheFlag",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "ReadDataFlag",
                  "type": "string",
                  "displayAs": "string",
                  "order": 36,
                  "title": "ReadDataFlag",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "UsedWorkerTasksFlag",
                  "type": "string",
                  "displayAs": "string",
                  "order": 37,
                  "title": "UsedWorkerTasksFlag",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Calc_HasSpillFlag",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 38,
                  "title": "Calc_HasSpillFlag",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Calc_ReadDataFlag",
                  "type": "decimal",
                  "displayAs": "number",
                  "order": 39,
                  "title": "Calc_ReadDataFlag",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Calc_UsedWorkerTasksFlag",
                  "type": "decimal",
                  "displayAs": "number",
                  "order": 40,
                  "title": "Calc_UsedWorkerTasksFlag",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "TotalUsedTimeInWarehouse",
                  "type": "float",
                  "displayAs": "number",
                  "order": 41,
                  "title": "TotalUsedTimeInWarehouse",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "TotalStatementTextTimeUsed",
                  "type": "float",
                  "displayAs": "number",
                  "order": 42,
                  "title": "TotalStatementTextTimeUsed",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Total_Warehouse_Period_Dollars",
                  "type": "decimal",
                  "displayAs": "number",
                  "order": 52,
                  "title": "Total_Warehouse_Period_Dollars",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Most Expensive Queries"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 30,
            "width": 4,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "df39f22f",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "e4d4c1ff",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    },
                    {
                      "name": "tags",
                      "expression": "`tags`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_name"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "warehouse_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "warehouse_name"
                  },
                  {
                    "fieldName": "sku_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "sku_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "sku_name"
                  },
                  {
                    "fieldName": "list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 5,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  },
                  {
                    "fieldName": "tags",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 6,
                    "title": "tags",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "tags"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "workspace_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 0,
                  "title": "workspace_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "warehouse_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 2,
                  "title": "warehouse_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "sql_type_from_sku",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100006,
                  "title": "sql_type_from_sku",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Untagged Warehouses Last 30 Days",
                "description": "These warehouses are not tagged and have been used in last 30 days; consider tagging them for cost attribution"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 91,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "3a46ac60",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "57a475b4",
                  "fields": [
                    {
                      "name": "NumberOfClustersOn",
                      "expression": "`NumberOfClustersOn`"
                    },
                    {
                      "name": "countdistinct(event_minute)",
                      "expression": "COUNT(DISTINCT `event_minute`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "y": {
                  "fieldName": "countdistinct(event_minute)",
                  "scale": {
                    "type": "quantitative",
                    "reverse": true
                  },
                  "displayName": "Count of Unique event_minute"
                },
                "color": {
                  "fieldName": "NumberOfClustersOn",
                  "scale": {
                    "type": "quantitative",
                    "colorRamp": {
                      "mode": "scheme",
                      "scheme": "greenblue"
                    }
                  },
                  "displayName": "NumberOfClustersOn"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "% of Time Warehouse Scaled at Cluster N",
                "showDescription": true,
                "description": "Number of minutues as percentage (y-axis) the specified number of clusters were up"
              },
              "mark": {
                "layout": "percent-stack"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 80,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "2d3e1953",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "57a475b4",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "event_minute",
                      "expression": "`event_minute`"
                    },
                    {
                      "name": "max(NumberOfClustersOn)",
                      "expression": "MAX(`NumberOfClustersOn`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "event_minute",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "event_minute"
                },
                "y": {
                  "fieldName": "max(NumberOfClustersOn)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Maximum NumberOfClustersOn"
                },
                "color": {
                  "fieldName": "warehouse_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "warehouse_name"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Cluster count per warehouse",
                "description": "Cluster count (y-axis) change with time (x-axis)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 85,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "7519e499",
            "textbox_spec": "### Cost Comparison and Change Analysis Section\n----\nThis section provides a targeted cost comparison for a user-defined time frame, enabling quick insights into spending trends and recent changes at a granular level. By entering a specific number of days (e.g., 7 days), users can view:\n\n1. **Comparative Cost Overview**: Displays the cost of the selected time period (e.g., last 7 days) alongside the preceding period, helping to track spending fluctuations over time and spot potential anomalies.\n\n2. **Detailed Change Analysis**: A breakdown of warehouse-level costs, showing exactly which warehouses have experienced cost increases or decreases during the specified timeframe. This detail helps users quickly pinpoint areas with significant changes, facilitating focused optimization efforts.\n\nThis feature provides a comprehensive snapshot of cost evolution, making it easy to track, compare, and act on changes in data usage and costs over time.\n"
          },
          "position": {
            "x": 0,
            "y": 37,
            "width": 6,
            "height": 5
          }
        }
      ]
    }
  ]
}